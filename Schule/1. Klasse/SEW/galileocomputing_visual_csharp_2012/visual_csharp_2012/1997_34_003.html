<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
      <meta name="title" content="Galileo Computing :: Visual C# 2012 - 34  ADO.NET &#8211; Daten im lokalen Speicher ">
      <meta name="author" content="Andreas Kühnel">
      <meta name="publisher" content="Galileo Press">
      <meta name="copyright" content="© Galileo Press, Bonn 2013">
      <meta name="Desription" content="Visual C# 2012 - Das umfassende Handbuch - 34  ADO.NET &#8211; Daten im lokalen Speicher ">
      <meta name="robots" content="INDEX,FOLLOW">
      <meta http-equiv="content-language" content="de">
      <title>Galileo Computing :: Visual C# 2012 - 34  ADO.NET &#8211; Daten im lokalen Speicher </title>
      <link rel="stylesheet" type="text/css" href="common/galileo_open.css">
      <link rel="stylesheet" type="text/css" href="common/prettify.css">
      <link rel="stylesheet" type="text/css" media="screen" href="common/css/lightbox.css"><script type="text/javascript" src="common/js/prototype.js"></script><script src="common/js/scriptaculous.js?load=effects,builder"></script><script type="text/javascript" src="common/js/lightbox.js"></script><link rel="prev" href="34_002.html">
      <link rel="next" href="1997_34_004.html"><script type="text/javascript" src="common/prettify.js"></script><script type="text/javascript" src="common/openwin.js"></script></head>
   <body vlink="#000099" link="#000099" alink="#000099" onload="prettyPrint()">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#000066">
         <tr>
            <td height="74" valign="bottom" colspan="2"><a href="https://www.galileo-press.de/openbook/?GPP=opvcs"><img src="common/galileocomputing_openbook.gif" width="200" height="56" border="0" alt="Galileo Computing < openbook &gt;" title="Galileo Computing < openbook &gt;"></a></td>
            <td width="80" height="74"><a href="https://www.galileo-press.de/3243/?GPP=opvcs"><img src="common/galileocomputing.gif" border="0" alt="Galileo Computing - Professionelle Bücher. Auch für Einsteiger." title="Galileo Computing - Professionelle Bücher. Auch für Einsteiger."></a></td>
         </tr>
      </table>
      <div align="right"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Professionelle Bücher. Auch für Einsteiger.</a></div><br><table class="tbl" border="0" cellpadding="0" cellspacing="0" width="100%">
         <tbody>
            <tr>
               <td width="190" valign="top">
                  <table class="tbl1" border="0" cellpadding="3" cellspacing="0" width="190" align="left">
                     <tbody>
                        <tr>
                           <td class="tbl2"><a class="nav" href="index.html">Inhaltsverzeichnis</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_00_001.html#dodtp98d144f0-bd8d-4de5-8086-32e7ca1478d7"> Vorwort zur 6. Auflage</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_01_001.html#dodtpf471901b-c92c-4256-b4a7-6c4233f40e97">1  Allgemeine Einführung in .NET</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_02_001.html#dodtpa6dfd9e4-6ebc-4240-b08a-4dd8e839b1e9">2  Grundlagen der Sprache C#</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_03_001.html#dodtpf766d18e-5ded-46aa-8e8e-625d86cb0d78">3  Das Klassendesign</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_04_001.html#dodtp1d1f07d4-0731-4e9c-8de8-d69493f7b393">4  Vererbung, Polymorphie und Interfaces</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_05_001.html#dodtp3fff44b2-cd1b-47b7-9a94-fbcb259a84b9">5  Delegates und Ereignisse</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_06_001.html#dodtpaccedd75-eaa3-4322-a479-e04396858096">6  Strukturen und Enumerationen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_07_001.html#dodtp77739224-c0d5-4b2a-9a3e-732e2dfca478">7  Fehlerbehandlung und Debugging</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_08_001.html#dodtp33cf4146-9c07-41aa-b128-fd667a737a33">8  Auflistungsklassen (Collections)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_09_001.html#dodtp066354eb-ea00-4a8d-aa5a-fa7bd96e026d">9  Generics &#8211; Generische Datentypen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_10_001.html#dodtp077ecd71-a5e8-46be-b6b5-6c31bc77dede">10  Weitere C#-Sprachfeatures</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_11_001.html#dodtp0c006063-d863-416e-b792-4cc39129b894">11  LINQ</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_12_001.html#dodtp2bfdab07-505d-4323-9885-77a8e59fa442">12  Arbeiten mit Dateien und Streams</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_13_001.html#dodtp49638af0-00f8-407f-9740-7dbc1e723fee">13  Binäre Serialisierung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_14_001.html#dodtp7327df50-2f94-44ea-8c62-26cb1aae6058">14  XML</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_15_001.html#dodtp61e706c0-d922-4db1-b2fb-cda3e1ff9a4c">15  Multithreading und die Task Parallel Library (TPL)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_16_001.html#dodtp1488d937-efc6-48e5-ba82-1547725215a5">16  Einige wichtige .NET-Klassen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_17_001.html#dodtp91f0667a-84db-4a4f-be78-6e8a0d8a3a2c">17  Projektmanagement und Visual Studio 2012</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_18_001.html#dodtp34972f67-6c1a-406f-a91d-ec8ff67058f9">18  Einführung in die WPF und XAML</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_19_001.html#dodtp2b691ef2-8859-4650-82c1-efe430ea7070">19  WPF-Layout-Container </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_20_001.html#dodtp7dad73d4-2c09-421f-a8d4-6a78c0a65acc">20  Fenster in der WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_21_001.html#dodtp193e3eb8-5130-4640-865a-fcdd743bac28">21  WPF-Steuerelemente</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_22_001.html#dodtp189c6448-45c3-4ee3-bf41-19ecfa0010d0">22  Elementbindungen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_23_001.html#dodtp5183a0da-5247-4a7c-ad83-22accc03224d">23  Konzepte von WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_24_001.html#dodtp0784a527-2ec1-411a-b5e4-add26ed79abb">24  Datenbindung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_25_001.html#dodtp5c4c4699-998d-48a0-b449-ac86d57d6ddb">25  Weitere Möglichkeiten der Datenbindung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_26_001.html#dodtp5591376e-61df-4e77-a551-681b9cc62287">26  Dependency Properties</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_27_001.html#dodtp00fbcc96-1850-421c-a0b4-f4f585913905">27  Ereignisse in der WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_28_001.html#dodtp0b2d55e9-c350-4f4b-b729-796ab6e638ec">28  WPF-Commands</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_29_001.html#dodtp3d560bbc-9ede-4881-af9f-d9c24c8c5ae8">29  Benutzerdefinierte Controls</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_30_001.html#dodtp6f0f9b84-f8f1-405a-b963-d9c64c6cf3d4">30  2D-Grafik</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_31_001.html#dodtpe8718b27-0d2c-45fd-a030-421a21b5d151">31  ADO.NET &#8211; Verbindungsorientierte Objekte</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_32_001.html#dodtp5631780e-021d-4716-a880-7604e981153d">32  ADO.NET &#8211; Das Command-Objekt</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_33_001.html#dodtp3e44ce92-e1cb-4420-9294-a993f673d1e4">33  ADO.NET &#8211; Der SqlDataAdapter</a></td>
                        </tr>
                        <tr>
                           <td><a class="navh" href="#dodtp02622bf1-44a0-453d-828f-5266aea64a96">34  ADO.NET &#8211; Daten im lokalen Speicher </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_35_001.html#dodtp44f9b504-b660-4f2e-bd26-072f4a498332">35  ADO.NET &#8211; Aktualisieren der Datenbank</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_36_001.html#dodtpd2ab99b1-a59b-43ef-abb1-e6775e3dddf5">36  Stark typisierte DataSets</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_37_001.html#dodtp97eab997-f0da-4739-b514-a73fccd2935a">37  Einführung in das ADO.NET Entity Framework</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_38_001.html#dodtp106a1823-39fd-4557-8819-0e6be4db7cce">38  Datenabfragen des Entity Data Models (EDM)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_39_001.html#dodtpcc04d69d-d046-42b7-a6f1-37c7e83c0276">39  Entitätsaktualisierung und Zustandsverwaltung </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_40_001.html#dodtp6a9ab46f-1f4f-41d8-9ab8-bd419b300904">40  Konflikte behandeln</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_41_001.html#dodtp160fa133-1df6-4ab9-a622-c56d87121c23">41  Plain Old CLR Objects (POCOs)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="stichwort.html">Stichwort</a></td>
                        </tr>
                        <tr>
                           <td><br><a class="navnav"><strong>Download:</strong></a>
                               <br><a href="http://download2.galileo-press.de/openbook/galileocomputing_visual_csharp_2012.zip" class="navnav">- openbook, ca. 26,1 MB</a>
                               <br><a href="http://download2.galileo-press.de/openbook/galileocomputing_visual_csharp_2012_beispiele.zip" class="navnav">- Beispiele, ca. 62,4 MB</a>
                           </td>
                        </tr>
                        <tr>
                           <td><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Buch bestellen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="#kommentar">Ihre Meinung?</a><br><br></td>
                        </tr>
                     </tbody>
                  </table>
               </td>
               <td width="10"><img src="common/spacer10.gif" width="10" height="10" alt="Spacer"></td>
               <td width="85%" valign="top">
                  <div style="line-height:100%">
                     <div align="center">
                        <table width="98%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                           <tbody>
                              <tr>
                                 <td width="100%" class="start" colspan="1" height="22" align="center">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                       <tbody>
                                          <tr>
                                             <td width="25%">
                                                <div align="left"><a href="1997_34_002.html" class="navnav"> &lt;&lt; zurück</a></div>
                                             </td>
                                             <td width="49%">
                                                <div align="center"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Galileo Computing</a> / <a href="https://www.galileo-press.de/openbook/?GPP=opvcs" class="navnav">
                                                      &lt;openbook&gt;</a> / <a href="index.html" class="navnav">Visual C# 2012</a></div>
                                             </td>
                                             <td width="25%">
                                                <div align="right"><a href="1997_34_004.html" class="navnav">vor &gt;&gt; </a></div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                              <tr>
                                 <td width="100%" valign="top">
                                    <table width="100%" border="0" cellpadding="10" cellspacing="0" class="box">
                                       <tbody>
                                          <tr>
                                             <td colspan="2"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="buchtitel">Visual C# 2012</a><span class="autor"> von Andreas Kühnel</span><br><span class="untertitel">Das umfassende Handbuch</span></td>
                                          </tr>
                                          <tr>
                                             <td valign="top" width="211">
                                                <dl>
                                                   <dt><a href="http://www.galileo-press.de/3243/?GPP=opvcs" class="navnav"><img src="common/9783836219976.png" border="0" alt="Buch: Visual C# 2012" title="Buch: Visual C# 2012"></a></dt>
                                                   <dd><br><a href="http://www.galileo-press.de/3243/?GPP=opvcs"><span class="autor"><strong>Visual C# 2012</strong><br><pressinfo><strong>Galileo Computing</strong><br>1402 S., 6., aktualisierte und erweiterte Auflage 2013, geb., mit DVD<br>49,90 Euro, ISBN 978-3-8362-1997-6
                                                            </pressinfo></span></a></dd>
                                                </dl>
                                             </td>
                                             <td width="80%">
                                                <table border="0">
                                                   <tbody>
                                                      <tr>
                                                         <td valign="baseline"><img src="common/pfeil_u.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="3" class="kap"><strong><a href="1997_34_001.html#dodtp02622bf1-44a0-453d-828f-5266aea64a96" class="navnav">34 ADO.NET &#8211; Daten im lokalen Speicher</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_001.html#dodtpb0a6b54d-a2fd-49b3-ad74-40d4f648f9f8" class="navnav">34.1 Allgemeines</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_002.html#dodtp886426a8-df4b-4c21-9276-e7a5a3976526" class="navnav">34.2 Verwenden des DataSet-Objekts</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_002.html#dodtp3df1e879-772f-448c-a00c-8305f51cbcab" class="navnav">34.2.1 Ein DataSet-Objekt erzeugen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_002.html#dodtp6a34ed9a-be49-4cf6-8f41-ebb91debd5dc" class="navnav">34.2.2 Die Anatomie einer DataTable</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_002.html#dodtp4fd9f9b3-5274-4034-82ba-9bd6d9c52dfd" class="navnav">34.2.3 Der Zugriff auf eine Tabelle im DataSet</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_002.html#dodtp10552e5b-7a26-4c4f-a22e-f64f02d61c74" class="navnav">34.2.4 Der Zugriff auf die Ergebnisliste</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_002.html#dodtpa27be2e9-1e69-42dd-9299-42a496e44790" class="navnav">34.2.5 Dateninformationen in eine XML-Datei schreiben</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_003.html#dodtp70d715fc-b77d-464a-8516-73f57c8e97f2" class="navh">34.3 Gültigkeitsprüfung im DataSet</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_003.html#dodtpa0d9fb56-936d-4beb-8004-c21e8aafb0e8" class="navh">34.3.1 Dem DataSet Schemainformationen übergeben</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_003.html#dodtpc5267308-6b92-4d7c-9cd9-42ebc2c1d59a" class="navh">34.3.2 Eigenschaften einer DataColumn, die der Gültigkeitsprüfung dienen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_003.html#dodtp8c627d3b-5016-430e-8077-2d2b88f86738" class="navh">34.3.3 Die Constraints-Klassen einer »DataTable«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_003.html#dodtp4dc3a53a-431d-4079-9b9c-6096f3759309" class="navh">34.3.4 Das Schema mit Programmcode erzeugen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_003.html#dodtp768a0e0f-a05d-4025-9c93-a5f3819ed7e1" class="navh">34.3.5 Schemainformationen mit SqlDataAdapter abrufen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_004.html#dodtp922d60dc-5c3f-4ee3-9444-9ea7efe46f9c" class="navnav">34.4 Änderungen in einer DataTable vornehmen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_004.html#dodtpc044423c-3977-45fc-a250-7292e904c5ed" class="navnav">34.4.1 Editieren einer DataRow</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_004.html#dodtp99b2f81d-879e-42f1-b5c0-e8cd3b3f17c6" class="navnav">34.4.2 Löschen einer Datenzeile</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_004.html#dodtpd0f35bd5-65ff-4bdd-9013-dc08e02eb4fc" class="navnav">34.4.3 Eine neue Datenzeile hinzufügen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_004.html#dodtp1d726dd4-29c6-4a45-8f7f-1092da5574fa" class="navnav">34.4.4 Der Sonderfall: Autoinkrementspalten</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_004.html#dodtpdf9dab7f-2302-41d3-8958-09df54038d6e" class="navnav">34.4.5 Was bei einer Änderung einer Datenzeile passiert</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_004.html#dodtp28b8697b-6d4c-48a5-90f4-f5b83d5c6153" class="navnav">34.4.6 Manuelles Steuern der Eigenschaft »DataRowState«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_005.html#dodtp8ae4d458-9920-410b-a24c-301979e7e7e4" class="navnav">34.5 Mit mehreren Tabellen arbeiten</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_005.html#dodtpd67115dd-ea19-43bc-9134-693831e52205" class="navnav">34.5.1 Der Weg über JOIN-Abfragen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_005.html#dodtp95f458fa-1fe0-4d10-96a6-2771242da3a6" class="navnav">34.5.2 Mehrere Tabellen in einem DataSet</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_005.html#dodtpc03c5e10-20b6-4330-8a5b-22af8d9a41e7" class="navnav">34.5.3 Eine DataRelation erzeugen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_005.html#dodtpe1762576-c632-41df-8d47-c9bf81289c8e" class="navnav">34.5.4 DataRelations und Einschränkungen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_005.html#dodtp5d4d2c54-85c7-4b18-8d4c-4b3937deb208" class="navnav">34.5.5 In Beziehung stehende Daten suchen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_005.html#dodtp10a11683-2fd1-460d-99e9-07d7800e5e2d" class="navnav">34.5.6 Ergänzung zum Speichern von Schemainformationen in einer XML-Schemadatei</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_006.html#dodtp37656b1b-cd4a-44b1-ac46-3ef94ddab2b0" class="navnav">34.6 Filtern und suchen in einer DataTable</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_006.html#dodtp5a6816bc-4ade-4f70-9f0c-07bd1ddd5e57" class="navnav">34.6.1 Die Methode »Find«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_006.html#dodtpab3789e2-239b-4d7c-b6c3-29f9a551b5bc" class="navnav">34.6.2 Die Methode »Select«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_34_007.html#dodtpa182a1ef-0451-4915-a5f8-33caafbb55b1" class="navnav">34.7 Objekte vom Typ »DataView«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtpf043a503-e5ed-4df4-9959-016bc7e52dc8" class="navnav">34.7.1 Einen »DataView« erzeugen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtpcb2f648d-660e-4d14-8d94-5158d9015276" class="navnav">34.7.2 Auf die Datenzeilen in einem »DataView« zugreifen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtp147a5101-0cbc-4a68-8f51-c6ae8d56de8f" class="navnav">34.7.3 Die Eigenschaft »Sort« und die Methode »Find«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtpb03964de-e949-479c-a2c0-52c4c95e23be" class="navnav">34.7.4 Die Methode »FindRows«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtp833926c6-0ddd-4187-889e-b70ba89b3a45" class="navnav">34.7.5 Die Eigenschaft »RowFilter«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtpab0076f8-4652-4c28-b2a8-a4acd975898f" class="navnav">34.7.6 Die Eigenschaft »RowStateFilter«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtpba3abb3e-147f-4b21-8380-b5b7fe754807" class="navnav">34.7.7 Änderungen an einem »DataView«-Objekt</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_34_007.html#dodtp8095dd31-c360-40a9-8ac3-83a0c3567fb0" class="navnav">34.7.8 Aus einem »DataView« eine »DataTable« erzeugen</a></strong></td>
                                                      </tr>
                                                   </tbody>
                                                </table>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                    <table width="100%" cellpadding="20" cellspacing="0" border="0" bgcolor="#eeeeee">
                                       <tbody>
                                          <tr>
                                             <td>
                                                <div class="main"><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp70d715fc-b77d-464a-8516-73f57c8e97f2" name="dodtp70d715fc-b77d-464a-8516-73f57c8e97f2"></a><h2 class="t2"><span class="cfett">34.3    </span><span class="cfett"> Gültigkeitsprüfung im DataSet</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpa0d9fb56-936d-4beb-8004-c21e8aafb0e8"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a></h2><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtpa0d9fb56-936d-4beb-8004-c21e8aafb0e8" name="dodtpa0d9fb56-936d-4beb-8004-c21e8aafb0e8"></a><h3 class="t3"><span class="cfett">34.3.1    </span><span class="cfett"> Dem DataSet Schemainformationen übergeben</span><a xmlns="http://www.w3.org/1999/xhtml" class="indexterm" id="dodtp50195988-0dba-465d-abaf-711b3fee2af6"></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpc5267308-6b92-4d7c-9cd9-42ebc2c1d59a"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp70d715fc-b77d-464a-8516-73f57c8e97f2"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Daten in einer <span class="clisting">DataTable</span> können editiert werden. Sie können auch neue Datenzeilen hinzufügen oder vorhandene
                                                      löschen. Wie das gemacht wird, werden Sie noch später in diesem Kapitel sehen. Unabhängig
                                                      davon, welche Änderungen Sie vorgenommen haben, betreffen diese zunächst nur das <span class="clisting">DataSet.</span> Die Produktionsdatenbank weiß davon nichts. Erst zu einem späteren Zeitpunkt werden
                                                      die Aktualisierungen mit der <span class="clisting">Update</span>-Methode des <span class="clisting">SqlDataAdapters</span> zur Originaldatenbank übermittelt und dort gespeichert.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Viele Spalten der Tabelle in der Datenbank unterliegen Gültigkeitsregeln: Beispielsweise
                                                      lassen einige nur eine maximale Zeichenanzahl zu, andere schreiben einen eindeutigen
                                                      Eintrag innerhalb der Datensätze der Tabelle vor oder lassen keinen NULL-Wert zu.
                                                      Eine <span class="clisting">DataTable</span>, die wir mit <span class="clisting">Fill</span> füllen, ist hingegen sehr »dumm«. Sie enthält zwar alle angeforderten Daten, weiß
                                                      aber nichts von den Gültigkeitsregeln, die in der Datenbank festgelegt sind. Die Folge
                                                      ist, dass in der Anwendung die Daten beliebig verändert werden können, ohne dass eine
                                                      Überprüfung erfolgt. Der anschließende Versuch, die Änderungen in die Datenbank zu
                                                      schreiben, wird jedoch scheitern, weil die Datenbank vor der endgültigen Aktualisierung
                                                      zuerst die Änderungen mit den Gültigkeitsregeln vergleicht und eine Verletzung feststellt.
                                                      Es kommt zu einer Ausnahme.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Im folgenden Beispielprogramm können Sie dies ausprobieren. Hierzu dient uns wieder
                                                      die schon reichlich bekannte Tabelle <span class="ckursiv">Products</span> der Datenbank <span class="ckursiv">Northwind</span>. Das Programm ermöglicht es, den Bezeichner des ersten Artikels, es handelt sich
                                                      dabei um <span class="ckursiv">Chai</span>, zu ändern. Dazu werden Sie an der Konsole aufgefordert. Die Änderung wird zuerst
                                                      in das <span class="clisting">DataSet</span> geschrieben, anschließend wird die Originaldatenbank aktualisiert. Die Aktualisierungslogik
                                                      mit der Methode <span class="clisting">Update</span> des <span class="clisting">SqlDataAdapters</span> sowie das zuvor erzeugte Objekt vom Typ <span class="clisting">SqlCommandBuilder</span> sollen uns an dieser Stelle nicht interessieren.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint"><span class="clistingfett">// Beispiel: ..\Kapitel 34\FehlgeschlageneAktualisierung</span><br></br><span class="clistingfett">class Program</span> {<br></br> <span class="clistingfett"> static void Main(string[] args)</span> {<br xmlns="">    SqlConnection con = new SqlConnection();<br xmlns="">    con.ConnectionString = "...";<br xmlns="">    SqlCommand cmd = new SqlCommand();<br xmlns="">    cmd.Connection = con;<br xmlns="">    cmd.CommandText = "SELECT ProductID, ProductName, UnitsInStock " +<br xmlns="">                      "FROM Products";<br xmlns="">    DataSet ds = new DataSet();<br xmlns="">    SqlDataAdapter da = new SqlDataAdapter(cmd);<br xmlns="">    da.Fill(ds);<br></br>    // Ausgabe der Ergebnisliste<br></br>    Console.WriteLine("Abfrageergebnis:\n");<br xmlns="">    foreach (DataRow row in ds.Tables[0].Rows)<br xmlns="">      Console.WriteLine("{0,-35}{1}", row[0], row[1]);<br xmlns="">    Console.WriteLine(new string('-',60));<br></br>    // Datenänderung<br></br>    Console.Write("Namensänderung von 'Chai': ");<br xmlns="">    ds.Tables[0].Rows[0]["ProductName"] = Console.ReadLine();<br xmlns="">    SqlCommandBuilder cmb = new SqlCommandBuilder(da);<br xmlns="">    da.Update(ds);<br xmlns="">    Console.ReadLine();<br xmlns="">  }<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 34.4  </span>Aktualisierung einer Datenzeile
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Beachten Sie bitte, dass das Feld <span class="ckursiv">ProductName</span> in der Datenbank auf eine Maximallänge von 40 Zeichen begrenzt ist. Ändern Sie den
                                                      Artikelbezeichner innerhalb dieser Grenzen, wird die Datenbank die Änderung annehmen.
                                                      Sollten Sie jedoch gegen die Beschränkung verstoßen, wird eine Ausnahme vom Typ <span class="clisting">SqlException</span> ausgelöst, die von der Datenbank initiiert wird. Die geänderte Spalte im <span class="clisting">DataSet</span> hatte keinen Einwand gegen die vorgenommene Änderung, denn bekanntlich sind die Daten
                                                      im <span class="clisting">DataSet</span> »dumm«. Der Versuch der endgültigen Aktualisierung scheitert jedoch an der Feldlängenbegrenzung
                                                      in der Datenbank.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Obwohl aufgrund der Einschränkungen in der Datenbank sichergestellt ist, dass keine
                                                      unzulässigen Daten geschrieben werden, stellt der gezeigte Ansatz keine gute Lösung
                                                      dar. Denken Sie nur an eine stark frequentierte Datenbank im Internet. Jeder Anwender,
                                                      der unzulässige Daten übermittelt, würde von der Datenbank in Form einer Ausnahme
                                                      über das Scheitern der Aktualisierung informiert. Der Datenfluss von der Datenbank
                                                      zum Anwender würde nicht nur das Netz belasten, sondern darüber hinaus auch die Performance
                                                      der Anwendung verschlechtern.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Besser ist es, wenn bereits das <span class="clisting">DataSet</span> die Gültigkeitsregeln kennt. Das hat zur Folge, dass Änderungen überprüft werden,
                                                      bevor sie der Datenbank übermittelt werden. In unserem Beispiel hätte dann das <span class="clisting">DataSet</span> eine Änderung des Artikelbezeichners abgelehnt, ohne dabei die Datenbank zu kontaktieren.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Um eine Gültigkeitsüberprüfung vom <span class="clisting">DataSet</span> vornehmen zu lassen, werden Schemainformationen benötigt, die auf drei verschiedenen
                                                      Wegen einer Anwendung bereitgestellt werden können:
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp">Die Schemainformationen werden mittels Programmcode für alle betreffenden Tabellen
                                                         und Spalten explizit festgelegt.
                                                      </li>
                                                      <li class="pgp">Die Schemainformationen werden von der Datenbank mit dem <span class="clisting">SqlDataAdapter</span> bezogen. Dazu bieten sich die Methode <span class="clisting">FillSchema</span><span class="clisting"><a class="indexterm" id="dodtpc1d7829f-161a-4a7c-ac9e-6b9fa2d0fe29"></a></span> sowie die Eigenschaft <span class="clisting">MissingSchemaAction</span><span class="clisting"><a class="indexterm" id="dodtp2f096219-b032-40a0-aa4e-5da352aa93da"></a></span> an.
                                                      </li>
                                                      <li class="pgp">Die Schemainformationen werden aus einer XML-Schemadatei bezogen.</li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Schemainformationen beschreiben Datenüberprüfungsmechanismen, die sogenannten Einschränkungen
                                                      (Constraints). Dabei handelt es sich um Einschränkungen auf Spalten- und Tabellenebene,
                                                      die auch von einer <span class="clisting">DataTable</span> und einer <span class="clisting">DataColumn</span> unterstützt werden. Ehe ich Ihnen zeige, wie Sie ein <span class="clisting">DataSet</span> davon überzeugen, eine Gültigkeitsüberprüfung vorzunehmen, sollten wir uns ansehen,
                                                      wie die Beschränkungen von ADO.NET realisiert werden.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtpc5267308-6b92-4d7c-9cd9-42ebc2c1d59a" name="dodtpc5267308-6b92-4d7c-9cd9-42ebc2c1d59a"></a><h3 class="t3"><span class="cfett">34.3.2    </span><span class="cfett"> Eigenschaften einer DataColumn, die der Gültigkeitsprüfung dienen</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp8c627d3b-5016-430e-8077-2d2b88f86738"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpa0d9fb56-936d-4beb-8004-c21e8aafb0e8"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Um die in der Anwendung eingegebenen Daten mittels Programmcode zu überprüfen, veröffentlicht
                                                      das <span class="clisting">DataColumn</span>-Objekt, mit dem eine Spalte der Abfrage beschrieben wird, einige Eigenschaften.
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 34.1  </span>Gültigkeitsbeschreibende Eigenschaften einer DataColumn
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Eigenschaft
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">AllowDBNull</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Mit dieser Eigenschaft legen Sie fest, ob eine Spalte den Wert NULL akzeptiert oder
                                                                  nicht.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MaxLength</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Mit dieser Eigenschaft legen Sie die Länge einer Zeichenfolge in einer Spalte fest.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">ReadOnly</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Sollen die Daten einer Spalte schreibgeschützt sein, setzen Sie diese Eigenschaft
                                                                  für die betreffende Spalte auf <span class="clisting">true</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">Unique</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Mit dieser Eigenschaft geben Sie an, ob die Werte in einer Spalte eindeutig sein müssen.
                                                                  Ist diese Eigenschaft einer Spalte auf <span class="clisting">true</span> gesetzt, prüft ADO.NET die Werte in jeder Zeile dieser Tabelle, wenn Sie in einer
                                                                  Datenzeile den Wert einer UNIQUE-Spalte ändern oder einen neuen Datensatz hinzufügen.
                                                                  Wird gegen die Regel verstoßen, wird die Ausnahme <span class="clisting">ConstraintException</span> ausgelöst.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp8c627d3b-5016-430e-8077-2d2b88f86738" name="dodtp8c627d3b-5016-430e-8077-2d2b88f86738"></a><h3 class="t3"><span class="cfett">34.3.3    </span><span class="cfett"> Die Constraints-Klassen einer »DataTable«</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp4dc3a53a-431d-4079-9b9c-6096f3759309"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpc5267308-6b92-4d7c-9cd9-42ebc2c1d59a"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die folgenden beiden Klassen beschreiben Einschränkungen einer <span class="clisting">DataTable</span>:
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp"><span class="clisting">UniqueConstraint</span></li>
                                                      <li class="pgp"><a class="indexterm" id="dodtpe54827ab-90ba-4cb9-b7e4-f0863eeb9a7a"></a><span class="clisting">ForeignKeyConstraint</span></li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><a class="indexterm" id="dodtp9978e763-9aee-411e-8047-1a7cc6ed7740"></a>Beide Klassen sind von der gleichen Basisklasse <span class="clisting">Constraint</span> abgeleitet. Da eine <span class="clisting">DataTable</span> mehrere Einschränkungen beschreiben kann, werden alle <span class="clisting">Constraint</span>-Objekte in einer Auflistung (Typ: <span class="clisting">ConstraintCollection</span><span class="clisting"><a class="indexterm" id="dodtpf32626f9-1070-4545-9b76-bc6c8408c439"></a></span>) verwaltet. Die Eigenschaft <span class="clisting">Constraint</span> der <span class="clisting">DataTable</span> liefert die Referenz auf diese Collection.
                                                   </p>
                                                   <h4 class="t4"> Die Klasse »UniqueConstraint«</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ein <span class="clisting">UniqueConstraint</span>-Objekt wird automatisch angelegt, wenn die Eigenschaft <span class="clisting">Unique</span> einer Spalte auf <span class="clisting">true</span> gesetzt wird. Gleichzeitig wird das Objekt der <span class="clisting">ConstraintCollection</span> hinzugefügt. Sie können ein <span class="clisting">UniqueConstraint</span>-Objekt natürlich auch per Code erzeugen und dessen Eigenschaft <span class="clisting">Columns</span> der Spalte übergeben, auf der die Einschränkung gesetzt wird. Das Setzen der Eigenschaft
                                                      <span class="clisting">Unique</span> einer Spalte ist aber einfacher. Trotzdem kann das explizite Erzeugen sinnvoll sein.
                                                      Das ist der Fall, wenn Sie sicherstellen müssen, dass die Kombination von Werten aus
                                                      mehreren Spalten eindeutig ist.
                                                   </p>
                                                   <h4 class="t4"> Die Klasse »ForeignKeyConstraint«</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Mit einem <span class="clisting">ForeignKeyConstraint</span>-Objekt können Sie festlegen, wie sich eine Beziehung zwischen Tabellen bezüglich
                                                      Datenänderungen auswirken soll. In der Tabelle <span class="ckursiv">Products</span> der <span class="ckursiv">Northwind</span>-Datenbank muss die Spalte <span class="ckursiv">CategoryID</span> einen Wert enthalten, der in der Tabelle <span class="ckursiv">Categories</span> enthalten ist. Der Spalte <span class="ckursiv">CategoryID</span> wird dazu ein <span class="clisting">ForeignKeyConstraint</span>-Objekt zugeordnet. Allerdings müssen Sie dieses nicht explizit erzeugen. Wenn Sie
                                                      im <span class="clisting">DataSet</span> eine Beziehung zwischen zwei Tabellen einrichten, wird automatisch ein <span class="clisting">ForeignKeyConstraint</span>-Objekt erzeugt. Wir werden auf das Thema der Einrichtung einer Beziehung zwischen
                                                      zwei Tabellen später noch einmal zurückkommen.
                                                   </p>
                                                   <h4 class="t4"> Primärschlüsselfelder</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Primärschlüssel werden in der <span class="clisting">DataTable</span> definiert. Die entsprechende Eigenschaft lautet <span class="clisting">PrimaryKey</span><span class="clisting"><a class="indexterm" id="dodtpaa83d113-f9f1-41a9-8571-18b54baa34b1"></a></span>. Dass ein Primärschlüssel nicht die Eigenschaft einer <span class="clisting">DataColumn</span> besitzt, liegt daran, dass viele Tabellen mehrere Spalten zu einem gemeinsamen Primärschlüssel
                                                      kombinieren. Die <span class="clisting">PrimaryKey</span>-Eigenschaft der <span class="clisting">DataTable</span> beschreibt deshalb auch ein Array von <span class="clisting">DataColumn</span>-Objekten. Beim Festlegen der <span class="clisting">PrimaryKey</span>-Eigenschaft wird ein <span class="clisting">UniqueConstraint</span>-Objekt erzeugt, um die Primärschlüsseleinschränkung durchzusetzen.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp4dc3a53a-431d-4079-9b9c-6096f3759309" name="dodtp4dc3a53a-431d-4079-9b9c-6096f3759309"></a><h3 class="t3"><span class="cfett">34.3.4    </span><span class="cfett"> Das Schema mit Programmcode erzeugen</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp768a0e0f-a05d-4025-9c93-a5f3819ed7e1"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpc1ad1faf-fc4d-456f-ae91-1de1fe00a03a"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Verhältnismäßig aufwendig ist die Bereitstellung eines Schemas. Mit den Eigenschaften
                                                      <span class="clisting">AllowDBNull</span><span class="clisting"><a class="indexterm" id="dodtp635a9db1-46fe-42d9-9c8c-50a1fa6807d2"></a></span>, <span class="clisting">MaxLength</span><span class="clisting"><a class="indexterm" id="dodtp7b8e41db-89cd-4291-baae-22a704facbfc"></a></span> und <span class="clisting">Unique</span><span class="clisting"><a class="indexterm" id="dodtpc3951021-6ab1-4f3d-8a67-5df0444aaecd"></a></span> einer <span class="clisting">DataColumn</span> sowie <span class="clisting">PrimaryKey</span> einer <span class="clisting">DataTable</span> können Sie Datenmechanismen implementieren. Mit <span class="clisting">ReadOnly</span><span class="clisting"><a class="indexterm" id="dodtpbfb6349f-0b24-4c23-ad67-a100894d15d8"></a>=true</span> haben Sie zudem die Möglichkeit, gültige Daten vor einer Veränderung durch den Benutzer
                                                      zu schützen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Auch im folgenden Beispiel soll der Artikelbezeichner eines Artikels der Tabelle <span class="ckursiv">Products</span> geändert werden. Ein ähnliches Beispiel habe ich ein paar Seiten zuvor schon einmal
                                                      gezeigt. Diesmal wird die <span class="clisting">DataTable</span> im <span class="clisting">DataSet</span> jedoch mit den Schemainformationen für die abgefragten Felder gefüllt. Aus Gründen
                                                      der Übersicht wird der entsprechende Programmcode in eine spezielle Methode ausgelagert,
                                                      die nach dem Füllen des <span class="clisting">DataSets</span> aufgerufen wird.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint"><span class="clistingfett">// Beispiel: ...\Kapitel 34\SchemaMitCode</span><br></br><span class="clistingfett">class Program</span> {<br></br> <span class="clistingfett"> static void Main(string[] args)</span> {<br xmlns="">    SqlConnection con = new SqlConnection();<br xmlns="">    con.ConnectionString = "...";<br xmlns="">    SqlCommand cmd = new SqlCommand();<br xmlns="">    cmd.Connection = con;<br xmlns="">    cmd.CommandText = "SELECT ProductID, ProductName, " +<br xmlns="">         "QuantityPerUnit, Discontinued FROM Products";<br xmlns="">    DataSet ds = new DataSet();<br xmlns="">    SqlDataAdapter da = new SqlDataAdapter(cmd);<br xmlns="">    da.Fill(ds);<br xmlns="">    FillSchemaInfos(ds.Tables[0]);<br></br>    // Der Artikelbezeichner des Artikels in der ersten Datenzeile<br></br>    // soll geändert werden<br></br>    DataRow row = ds.Tables[0].Rows[0];<br xmlns="">    Console.Write("Produktname ändern: ");<br xmlns="">    row["ProductName"] = Console.ReadLine();<br></br>    // Änderung in die Originaldatenbank schreiben<br></br>    SqlCommandBuilder cmb = new SqlCommandBuilder(da);<br xmlns="">    da.Update(ds);<br xmlns="">    Console.WriteLine("Aktualisierung erfolgreich.");<br xmlns="">    Console.ReadLine();<br xmlns="">  }<br></br>  // Diese Methode füllt die Tabelle mit Schemainformationen<br></br> <span class="clistingfett"> static void FillSchemaInfos(DataTable tbl)</span> {<br></br>    // ProductID<br></br>    tbl.PrimaryKey = new DataColumn[]{ tbl.Columns["ProductID"]};<br></br>    // ProductName<br></br>    tbl.Columns["ProductName"].MaxLength = 40;<br xmlns="">    tbl.Columns["ProductName"].AllowDBNull = false;<br></br>    // QuantityPerUnit<br></br>    tbl.Columns["QuantityPerUnit"].MaxLength = 20;<br></br>    // Discontinued<br></br>    tbl.Columns["Discontinued"].AllowDBNull = false;<br xmlns="">  }<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 34.5  </span>Aktualisierung im Kontext von Metadateninformationen
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sie können selbst bestimmen, welchen Bezeichner der Artikel bekommen soll. Entscheiden
                                                      Sie sich für einen Bezeichner mit maximal 40 Zeichen, wird die Änderung in die Datenbank
                                                      geschrieben. Geben Sie aber mehr als 40 Zeichen ein, wird eine Ausnahme vom Typ <span class="clisting">ArgumentException</span> ausgelöst. Vielleicht erinnern Sie sich an das ähnliche Aktualisierungsbeispiel weiter
                                                      oben. Dort wurde das Überschreiten der zulässigen Maximallänge des Feldes <span class="ckursiv">ProductName</span> mit einer Ausnahme vom Typ <span class="clisting">SqlException</span> beantwortet. Diese kam vom SQL Server. Die Ausnahme <span class="clisting">ArgumentException</span><span class="clisting"><a class="indexterm" id="dodtp48bd7c1b-7179-4bc3-af82-41103e59ea43"></a></span> hingegen wird von ADO.NET in der Clientanwendung ausgelöst.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Vergleichen Sie auch, in welcher Codezeile die Ausnahme ausgelöst wird: Aktualisieren
                                                      Sie ohne Schemainformationen, ist die <span class="clisting">Update</span>-Methode des <span class="clisting">SqlDataAdapters</span> der Urheber. Liegen Schemainformationen im <span class="clisting">DataSet</span> vor und wird gegen die Einschränkungen verstoßen, handelt es sich um die Anweisung
                                                      mit der fehlschlagenden Zuweisung, in unserem Beispiel also:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">row["ProductName"] = Console.ReadLine();<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das <span class="clisting">DataSet</span> nimmt die Änderung überhaupt nicht entgegen. Damit ist gezeigt, dass ein <span class="clisting">DataSet</span> mit Schemainformationen zur Entlastung des Datenbankservers beiträgt.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp768a0e0f-a05d-4025-9c93-a5f3819ed7e1" name="dodtp768a0e0f-a05d-4025-9c93-a5f3819ed7e1"></a><h3 class="t3"><span class="cfett">34.3.5    </span><span class="cfett"> Schemainformationen mit SqlDataAdapter abrufen</span><a xmlns="http://www.w3.org/1999/xhtml" href="#"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp4dc3a53a-431d-4079-9b9c-6096f3759309"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <h4 class="t4"> Schemainformationen mit »FillSchema« abrufen</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Enthält ein <span class="clisting">DataSet</span> mehrere Tabellen mit jeweils vielen Spalten, kann die Codierung der Schemainformationen
                                                      ziemlich aufwendig sein. Ebenso können Sie mit der Methode <span class="clisting">FillSchema</span> des <span class="clisting">SqlDataAdapters</span> alle Schemainformationen für das <span class="clisting">DataSet</span> oder die <span class="clisting">DataTable</span> abrufen. Die Methode ruft das Schema bei der Datenbank ab. Grundlage ist dabei das
                                                      in <span class="clisting">SelectCommand</span> beschriebene SELECT-Kommando. Als Ergebnis des Methodenaufrufs werden die Eigenschaften
                                                      <span class="clisting">ReadOnly</span>, <span class="clisting">AllowDBNull</span>, <span class="clisting">AutoIncrement</span>, <span class="clisting">Unique</span> und <span class="clisting">MaxLength</span> der in der Abfrage enthaltenen Spalten gesetzt. Außerdem werden die Eigenschaften
                                                      <span class="clisting">PrimaryKey</span> und <span class="clisting">Constraints</span> der entsprechenden Tabelle festgelegt.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="clisting">FillSchema</span> ist mehrfach überladen. Alle Überladungen erwarten ein Argument vom Typ der Enumeration
                                                      <span class="clisting">SchemaType</span>. Die Aufzählung hat zwei Mitglieder: <span class="clisting">Source</span> und <span class="clisting">Mapped</span>. Über diese Parameter wird gesteuert, ob der <span class="clisting">SqlDataAdapter</span> die Zuordnungen, die in der <span class="clisting">DataTableMappingCollection</span> und der <span class="clisting">DataColumnMappingCollection</span> angegeben sind, verwenden soll.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><a class="indexterm" id="dodtpb126643c-9b05-4a6a-b2fc-192cd850fa94"></a>Beschreiben Sie mittels Programmcode die Gültigkeitsregeln, können diese zu jedem
                                                      beliebigen Zeitpunkt gesetzt werden. Es muss nur vor der Aktualisierung der Daten
                                                      im <span class="clisting">DataSet</span> sein. Benutzen Sie dagegen die Methode <span class="clisting">FillSchema</span>, muss dies vor dem Füllen des <span class="clisting">DataSets</span> erfolgen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">[...]<br xmlns="">DataSet ds = new DataSet();<br xmlns="">da.FillSchema(ds, SchemaType.Source);<br xmlns="">da.Fill(ds);<br xmlns="">[...]<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der Aufruf der Methode ist einerseits natürlich sehr bequem, aber andererseits dürfen
                                                      Sie nicht vergessen, dass dabei sowohl das Netzwerk als auch die Datenbank selbst
                                                      belastet werden.
                                                   </p>
                                                   <h4 class="t4"> Die Eigenschaft »MissingSchemaAction« des SqlDataAdapters</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Per Vorgabe ist der <span class="clisting">SqlDataAdapter</span> so eingestellt, dass Spalten zu einer <span class="clisting">DataTable</span> hinzugefügt werden, wenn diese in der <span class="clisting">DataTable</span> noch nicht existieren. Damit stellt der <span class="clisting">SqlDataAdapter</span> sicher, die Ergebnisse einer Abfrage speichern zu können. Gesteuert wird dieses Verhalten
                                                      von der Eigenschaft <span class="clisting">MissingSchemaAction</span>, die Werte der gleichnamigen Aufzählung beschreibt.
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 34.2  </span>Die Werte der Enumeration MissingSchemaAction
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Wert
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">Add</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Fügt die erforderlichen Spalten zum Vervollständigen des Schemas hinzu.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">AddWithKey</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Findet der <span class="clisting">SqlDataAdapter</span> eine Spalte, die noch nicht in der <span class="clisting">DataTable</span> existiert, fügt er die Spalte hinzu und setzt die Eigenschaften <span class="clisting">MaxLength</span> und <span class="clisting">AllowDBNull</span>. Falls die <span class="clisting">DataTable</span> noch nicht existiert, wird die Datenbank zudem nach Primärschlüsselinformationen
                                                                  abgefragt.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">Error</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Wenn die angegebene Spaltenzuordnung fehlt, wird die Ausnahme <span class="clisting">InvalidOperation</span> ausgelöst.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">Ignore</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Ignoriert die zusätzlichen Spalten.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><a class="indexterm" id="dodtp845743c4-489f-4dba-aed7-311cfda56721"></a>Legen Sie die Eigenschaft <span class="clisting">MissingSchemaAction</span> auf den Wert <span class="clisting">AddWithKey</span> fest, werden ähnlich wie mit der Methode <span class="clisting">FillSchema</span> die Schemainformationen abgerufen. Diese sind jedoch auf den Primärschlüssel der
                                                      Tabelle sowie die Einschränkungen <span class="clisting">AllowDBNull</span> und <span class="clisting">MaxLength</span> der Spalten beschränkt. <span class="clisting">Unique</span>, <span class="clisting">AutoIncrement</span> und <span class="clisting">ReadOnly</span> werden hierbei nicht berücksichtigt.
                                                   </p>
                                                   <h4 class="t4"> Schemainformationen aus einer XML-Schemadatei beziehen</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Nun kennen Sie zwei Varianten, Metadaten einer Tabelle im <span class="clisting">DataSet</span> bereitzustellen. Sie wissen, dass es sehr einfach ist, mit <span class="clisting">FillSchema</span> oder <span class="clisting">MissingSchemaAction=AddWithKey</span> zu arbeiten. Nachteil dabei ist die erhöhte Belastung des Netzes und der Datenbank.
                                                      Daher ist dies wohl eher nur für Ad-hoc-Abfragen geeignet. Alternativ können Sie die
                                                      Schemainformationen auch mittels Programmcode beschreiben. Zur Laufzeit ist das sicher
                                                      effektiv, weil das Netz und die Datenbank nur die tatsächlich benötigten Dateninformationen
                                                      liefern müssen, während die Metadaten im Code beschrieben werden. Allerdings bedeutet
                                                      das einen nicht zu vernachlässigenden Programmieraufwand.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die nun vorgestellte dritte Möglichkeit ist wohl in den meisten Fällen diejenige,
                                                      die sich am besten eignet. Ausgangspunkt sind zwei Methoden des <span class="clisting">DataSets</span>: <span class="clisting">WriteXmlSchema</span> und <span class="clisting">ReadXmlSchema</span>. Mit <span class="clisting">WriteXmlSchema</span> können Sie die Schemainformationen eines <span class="clisting">DataSets</span> in ein XML-Dokument schreiben und es später mit <span class="clisting">ReadXmlSchema</span> auswerten. Das Schema enthält Definitionen von Tabellen, Beziehungen und Einschränkungen.
                                                      XML-Schemadateien haben üblicherweise die Dateiendung <span class="ckursiv">.xsd</span>.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Bevor Sie das Schema eines <span class="clisting">DataSets</span> in einer Schemadatei speichern, muss das Schema im <span class="clisting">DataSet</span> bekannt sein. Sie können sich dieses daher zur Entwicklungszeit mit <span class="clisting">FillSchema</span> besorgen und anschließend mit <span class="clisting">WriteXmlSchema</span> in einer Datei speichern.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">ds.WriteXmlSchema(@"D:\Products.xsd");<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die erzeugte Schemadatei muss zusammen mit der Anwendung ausgeliefert werden. In Abbildung
                                                      34.2 sehen Sie die Schemadatei, die auf einer Abfrage basiert, die die Spalten <span class="ckursiv">ProductID</span> und <span class="ckursiv">ProductName</span> der Tabelle <span class="ckursiv">Products</span> wiedergibt.
                                                   </p>
                                                   <p><a href="bilder/34_02.png" rel="lightbox" title="Beispiel einer mit der Methode »WriteXmlSchema« erzeugten Schemadatei"><img class="bild" border="1" src="bilderklein/klein34_02.png" alt="Abbildung"></a></p>
                                                   <p class="pbildunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Abbildung 34.2  </span>Beispiel einer mit der Methode »WriteXmlSchema«<a xmlns="http://www.w3.org/1999/xhtml" class="indexterm" id="dodtp32d255fe-c8bc-488d-8778-6358f58ff461"></a> erzeugten Schemadatei
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sie erkennen, dass die Spalte <span class="ckursiv">ProductID</span> die Primärschlüsselspalte der Tabelle beschreibt. <span class="clisting">AutoIncrement=True</span> signalisiert, das der Spaltenwert bei einer neu hinzugefügten Spalte automatisch
                                                      erhöht wird. Infolgedessen gilt für die Spalte <span class="ckursiv">ProductID</span> auch <span class="clisting">ReadOnly=True</span>. Die Spalte <span class="ckursiv">ProductName</span> weist lediglich eine Einschränkung auf, nämlich die Begrenzung auf maximal 40 Zeichen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Auswertung einer Schemadatei ist sehr einfach. Zur Laufzeit erzeugen Sie zuerst
                                                      das <span class="clisting">DataSet</span>-Objekt, lesen anschließend die Schemadatei ein und füllen danach das <span class="clisting">DataSet</span> mit den Daten.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">[...]<br xmlns="">DataSet ds = new DataSet();<br xmlns="">ds.ReadXmlSchema(@"D:\Products.xsd");<br xmlns="">da.Fill(ds);<br></pre></div>
                                                   <h4 class="t4"> Dateninformationen und Schemadaten in eine Datei schreiben</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Mit <span class="clisting">WriteXmlSchema</span> erzeugen Sie eine Schemadatei, die die Metadaten des <span class="clisting">DataSets</span> beinhaltet. Mit der einfach parametrisierten Methode <span class="clisting">WriteXml</span> des <span class="clisting">DataSets</span> lassen sich die Daten in einer XML-Datei sichern.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Benötigen Sie beide Informationen, müssen Sie nicht zwangsläufig Metadaten und Dateninformationen
                                                      jeweils in einer separaten Datei speichern. Mit einer Überladung von <span class="clisting">WriteXml</span> lässt sich der aktuelle Inhalt des <span class="clisting">DataSets</span> als XML-Daten mit den Metadaten als XSD-Inlineschema beschreiben. Sowohl Daten als
                                                      auch Schema sind in einer Datei gespeichert.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">ds.WriteXml(@"D:\Products.xml", XmlWriteMode.WriteSchema);<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der Vorgabewert von <span class="clisting">XmlWriteMode</span> ist <span class="clisting">IgnoreSchema</span>. Das ist die Einstellung, wenn Sie die einfach parametrisierte Methode aufrufen.
                                                   </p><br><hr><a name="kommentar"></a><h3>Ihr Kommentar</h3>
                                                   <p>Wie hat Ihnen das &lt;openbook&gt; gefallen? Wir freuen uns immer über Ihre freundlichen
                                                      und kritischen Rückmeldungen.
                                                   </p>
                                                   <!--<form action="http://www.galileo-press.de/feedback/openbook" method="post" style="text-align: center; margin-top: 10px;"><input type="hidden" name="openbookurl" value="https://www.galileo-press.de/openbook/?GPP=opvcs34_003.html"><input type="hidden" name="buchtitel" value="Visual C# 2012"><input type="hidden" name="Kapitel" value="34  ADO.NET &#8211; Daten im lokalen Speicher "><table border="0">
                                                         <tbody>
                                                            <tr>
                                                               <td><label for="name">Name</label><br></td>
                                                               <td><input type="text" name="name" id="name" size="40"><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td><label for="email">E-Mail</label><br></td>
                                                               <td><input type="text" name="email" id="email" size="40"><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td valign="top"><label for="comment">Ihr Kommentar</label><br></td>
                                                               <td><textarea name="comment" id="comment" rows="10" cols="40"></textarea><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td></td>
                                                               <td><input type="submit" value="Kommentar absenden"></td>
                                                            </tr>
                                                         </tbody>
                                                      </table>
                                                   </form>--><a href="https://www.galileo-press.de/feedback/produkt/3243/">>> Zum Feedback-Formular</a>
                                                </div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                              <tr>
                                 <td width="100%" class="start" colspan="1" height="22" align="center">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                       <tbody>
                                          <tr>
                                             <td width="25%"><a href="1997_34_002.html" class="navnav"> &lt;&lt; zurück</a></td>
                                             <td width="49%">
                                                <div align="center"><a class="navnav" href="#">&lt;top&gt;</a></div>
                                             </td>
                                             <td align="right" width="25%">
                                                <div align="right"><a href="1997_34_004.html" class="navnav">vor &gt;&gt;
                                                      </a></div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                  </div>
               </td>
               <td width="10" valign="top"></td>
               <td width="160" valign="top"><table border="0" cellpadding="0" cellspacing="0" width="160">
                  <tbody><tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2">
                  &nbsp;<a href="https://www.galileo-press.de/?GPP=opvcs" class="autor">
                  <strong>Zum Katalog</strong></a>
                  </td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2">
                  <img src="common/leer.gif" border="0" height="1" width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td><a href="https://www.galileo-press.de/3243/?GPP=opvcs">
                  <img src="common/1997.png" width="118" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Visual C# 2012" title="Zum Katalog: Visual C# 2012">
                  <br><br><strong>Visual C# 2012</strong><br><img src="common/pfeil_rechts5.gif" border="0"
                  alt="">Jetzt bestellen</a><br /><br />
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2"><span class="autor"><strong>&nbsp;Ihre Meinung?</strong></a></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td>Wie hat Ihnen das &lt;openbook&gt; gefallen?<br><a href="#kommentar"><img src="common/pfeil_rechts5.gif"
                  border="0" alt="">Ihre Meinung</a>
                  <br><br></td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2">&nbsp;<a href="https://www.galileo-press.de/?GPP=opvcs"
                  class="autor"><strong>Buchempfehlungen</strong></a></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3175/?GPP=opvcs">
                  <img src="common/1954.png" width="113" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Professionell entwickeln mit Visual C# 2012"><br><br><br><br><br><br>&nbsp;Professionell<br>&nbsp;entwickeln mit<br>&nbsp;Visual C# 2012</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3179/?GPP=opvcs">
                  <img src="common/1956.png" width="118" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Windows Presentation Foundation 4.5"><br><br><br><br><br><br><br>&nbsp;Windows Presentation<br>&nbsp;Foundation 4.5<br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3196/?GPP=opvcs">
                  <img src="common/1968.png" width="111" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Windows Store Apps mit XAML und C#"><br><br><br><br><br><br><br>&nbsp;Windows Store Apps<br>&nbsp;mit XAML und C#<br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3189/?GPP=opvcs">
                  <img src="common/1960.png" width="110" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Einstieg in Visual C# 2012"><br><br><br><br><br><br><br>&nbsp;Einstieg in<br>&nbsp;Visual C# 2012</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3214/?GPP=opvcs">
                  <img src="common/1967.png" width="110" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Einstieg in WPF 4.5"><br><br><br><br><br><br><br>&nbsp;Einstieg in WPF 4.5</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/2853/?GPP=opvcs">
                  <img src="common/1756.png" width="121" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Schrödinger programmiert C++"><br><br><br><br><br><br><br>&nbsp;Schrödinger<br>&nbsp;programmiert C++</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/2824/?GPP=opvcs">
                  <img src="common/1732.png" width="109" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: C++11 programmieren"><br><br><br><br><br><br><br>&nbsp;C++11 programmieren</a><br><br></td>
                  </tr>
                  </table></td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2"><span class="autor"><strong>&nbsp;Shopping</strong></span></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td><b>Versandkostenfrei</b> bestellen in Deutschland und &Ouml;sterreich<br><a href="https://www.galileo-press.de/hilfe/bestellung_6?GPP=opvcs"><img
                  src="common/pfeil_rechts5.gif" border="0" alt="Info">Info</a><br><br></td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </tbody></table>
                  <br><br><hr align="center" width="70%"><br><div align="center">
                  <p class="standard"><b>Copyright © Galileo Press 2013</b><br>Für Ihren privaten Gebrauch
                  dürfen Sie die Online-Version natürlich ausdrucken. Ansonsten unterliegt das &lt;openbook&gt;
                  denselben Bestimmungen, wie die gebundene Ausgabe: Das Werk einschließlich aller seiner
                  Teile ist urheberrechtlich geschützt. Alle Rechte vorbehalten einschließlich der Vervielfältigung,
                  Übersetzung, Mikroverfilmung sowie Einspeicherung und Verarbeitung in elektronischen
                  Systemen.</p><br><a href="https://www.galileo-press.de/">[Galileo Computing]</a><br><br>Galileo
                  Press, Rheinwerkallee 4, 53227 Bonn, Tel.: 0228.42150.0, Fax 0228.42150.77, <a href="mailto:info@galileo-press.de">info@galileo-press.de</a></div><br><br>
               </td>
            </tr>
         </tbody>
      </table>
   </body>
</html>