<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
      <meta name="title" content="Galileo Computing :: Visual C# 2012 - 14  XML">
      <meta name="author" content="Andreas Kühnel">
      <meta name="publisher" content="Galileo Press">
      <meta name="copyright" content="© Galileo Press, Bonn 2013">
      <meta name="Desription" content="Visual C# 2012 - Das umfassende Handbuch - 14  XML">
      <meta name="robots" content="INDEX,FOLLOW">
      <meta http-equiv="content-language" content="de">
      <title>Galileo Computing :: Visual C# 2012 - 14  XML</title>
      <link rel="stylesheet" type="text/css" href="common/galileo_open.css">
      <link rel="stylesheet" type="text/css" href="common/prettify.css">
      <link rel="stylesheet" type="text/css" media="screen" href="common/css/lightbox.css"><script type="text/javascript" src="common/js/prototype.js"></script><script src="common/js/scriptaculous.js?load=effects,builder"></script><script type="text/javascript" src="common/js/lightbox.js"></script><link rel="prev" href="14_006.html">
      <link rel="next" href="1997_14_008.html"><script type="text/javascript" src="common/prettify.js"></script><script type="text/javascript" src="common/openwin.js"></script></head>
   <body vlink="#000099" link="#000099" alink="#000099" onload="prettyPrint()">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#000066">
         <tr>
            <td height="74" valign="bottom" colspan="2"><a href="https://www.galileo-press.de/openbook/?GPP=opvcs"><img src="common/galileocomputing_openbook.gif" width="200" height="56" border="0" alt="Galileo Computing < openbook &gt;" title="Galileo Computing < openbook &gt;"></a></td>
            <td width="80" height="74"><a href="https://www.galileo-press.de/3243/?GPP=opvcs"><img src="common/galileocomputing.gif" border="0" alt="Galileo Computing - Professionelle Bücher. Auch für Einsteiger." title="Galileo Computing - Professionelle Bücher. Auch für Einsteiger."></a></td>
         </tr>
      </table>
      <div align="right"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Professionelle Bücher. Auch für Einsteiger.</a></div><br><table class="tbl" border="0" cellpadding="0" cellspacing="0" width="100%">
         <tbody>
            <tr>
               <td width="190" valign="top">
                  <table class="tbl1" border="0" cellpadding="3" cellspacing="0" width="190" align="left">
                     <tbody>
                        <tr>
                           <td class="tbl2"><a class="nav" href="index.html">Inhaltsverzeichnis</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_00_001.html#dodtp98d144f0-bd8d-4de5-8086-32e7ca1478d7"> Vorwort zur 6. Auflage</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_01_001.html#dodtpf471901b-c92c-4256-b4a7-6c4233f40e97">1  Allgemeine Einführung in .NET</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_02_001.html#dodtpa6dfd9e4-6ebc-4240-b08a-4dd8e839b1e9">2  Grundlagen der Sprache C#</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_03_001.html#dodtpf766d18e-5ded-46aa-8e8e-625d86cb0d78">3  Das Klassendesign</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_04_001.html#dodtp1d1f07d4-0731-4e9c-8de8-d69493f7b393">4  Vererbung, Polymorphie und Interfaces</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_05_001.html#dodtp3fff44b2-cd1b-47b7-9a94-fbcb259a84b9">5  Delegates und Ereignisse</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_06_001.html#dodtpaccedd75-eaa3-4322-a479-e04396858096">6  Strukturen und Enumerationen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_07_001.html#dodtp77739224-c0d5-4b2a-9a3e-732e2dfca478">7  Fehlerbehandlung und Debugging</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_08_001.html#dodtp33cf4146-9c07-41aa-b128-fd667a737a33">8  Auflistungsklassen (Collections)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_09_001.html#dodtp066354eb-ea00-4a8d-aa5a-fa7bd96e026d">9  Generics &#8211; Generische Datentypen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_10_001.html#dodtp077ecd71-a5e8-46be-b6b5-6c31bc77dede">10  Weitere C#-Sprachfeatures</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_11_001.html#dodtp0c006063-d863-416e-b792-4cc39129b894">11  LINQ</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_12_001.html#dodtp2bfdab07-505d-4323-9885-77a8e59fa442">12  Arbeiten mit Dateien und Streams</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_13_001.html#dodtp49638af0-00f8-407f-9740-7dbc1e723fee">13  Binäre Serialisierung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navh" href="#dodtp7327df50-2f94-44ea-8c62-26cb1aae6058">14  XML</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_15_001.html#dodtp61e706c0-d922-4db1-b2fb-cda3e1ff9a4c">15  Multithreading und die Task Parallel Library (TPL)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_16_001.html#dodtp1488d937-efc6-48e5-ba82-1547725215a5">16  Einige wichtige .NET-Klassen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_17_001.html#dodtp91f0667a-84db-4a4f-be78-6e8a0d8a3a2c">17  Projektmanagement und Visual Studio 2012</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_18_001.html#dodtp34972f67-6c1a-406f-a91d-ec8ff67058f9">18  Einführung in die WPF und XAML</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_19_001.html#dodtp2b691ef2-8859-4650-82c1-efe430ea7070">19  WPF-Layout-Container </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_20_001.html#dodtp7dad73d4-2c09-421f-a8d4-6a78c0a65acc">20  Fenster in der WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_21_001.html#dodtp193e3eb8-5130-4640-865a-fcdd743bac28">21  WPF-Steuerelemente</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_22_001.html#dodtp189c6448-45c3-4ee3-bf41-19ecfa0010d0">22  Elementbindungen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_23_001.html#dodtp5183a0da-5247-4a7c-ad83-22accc03224d">23  Konzepte von WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_24_001.html#dodtp0784a527-2ec1-411a-b5e4-add26ed79abb">24  Datenbindung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_25_001.html#dodtp5c4c4699-998d-48a0-b449-ac86d57d6ddb">25  Weitere Möglichkeiten der Datenbindung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_26_001.html#dodtp5591376e-61df-4e77-a551-681b9cc62287">26  Dependency Properties</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_27_001.html#dodtp00fbcc96-1850-421c-a0b4-f4f585913905">27  Ereignisse in der WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_28_001.html#dodtp0b2d55e9-c350-4f4b-b729-796ab6e638ec">28  WPF-Commands</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_29_001.html#dodtp3d560bbc-9ede-4881-af9f-d9c24c8c5ae8">29  Benutzerdefinierte Controls</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_30_001.html#dodtp6f0f9b84-f8f1-405a-b963-d9c64c6cf3d4">30  2D-Grafik</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_31_001.html#dodtpe8718b27-0d2c-45fd-a030-421a21b5d151">31  ADO.NET &#8211; Verbindungsorientierte Objekte</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_32_001.html#dodtp5631780e-021d-4716-a880-7604e981153d">32  ADO.NET &#8211; Das Command-Objekt</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_33_001.html#dodtp3e44ce92-e1cb-4420-9294-a993f673d1e4">33  ADO.NET &#8211; Der SqlDataAdapter</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_34_001.html#dodtp02622bf1-44a0-453d-828f-5266aea64a96">34  ADO.NET &#8211; Daten im lokalen Speicher </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_35_001.html#dodtp44f9b504-b660-4f2e-bd26-072f4a498332">35  ADO.NET &#8211; Aktualisieren der Datenbank</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_36_001.html#dodtpd2ab99b1-a59b-43ef-abb1-e6775e3dddf5">36  Stark typisierte DataSets</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_37_001.html#dodtp97eab997-f0da-4739-b514-a73fccd2935a">37  Einführung in das ADO.NET Entity Framework</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_38_001.html#dodtp106a1823-39fd-4557-8819-0e6be4db7cce">38  Datenabfragen des Entity Data Models (EDM)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_39_001.html#dodtpcc04d69d-d046-42b7-a6f1-37c7e83c0276">39  Entitätsaktualisierung und Zustandsverwaltung </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_40_001.html#dodtp6a9ab46f-1f4f-41d8-9ab8-bd419b300904">40  Konflikte behandeln</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_41_001.html#dodtp160fa133-1df6-4ab9-a622-c56d87121c23">41  Plain Old CLR Objects (POCOs)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="stichwort.html">Stichwort</a></td>
                        </tr>
                        <tr>
                           <td><br><a class="navnav"><strong>Download:</strong></a>
                               <br><a href="http://download2.galileo-press.de/openbook/galileocomputing_visual_csharp_2012.zip" class="navnav">- openbook, ca. 26,1 MB</a>
                               <br><a href="http://download2.galileo-press.de/openbook/galileocomputing_visual_csharp_2012_beispiele.zip" class="navnav">- Beispiele, ca. 62,4 MB</a>
                           </td>
                        </tr>
                        <tr>
                           <td><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Buch bestellen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="#kommentar">Ihre Meinung?</a><br><br></td>
                        </tr>
                     </tbody>
                  </table>
               </td>
               <td width="10"><img src="common/spacer10.gif" width="10" height="10" alt="Spacer"></td>
               <td width="85%" valign="top">
                  <div style="line-height:100%">
                     <div align="center">
                        <table width="98%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                           <tbody>
                              <tr>
                                 <td width="100%" class="start" colspan="1" height="22" align="center">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                       <tbody>
                                          <tr>
                                             <td width="25%">
                                                <div align="left"><a href="1997_14_006.html" class="navnav"> &lt;&lt; zurück</a></div>
                                             </td>
                                             <td width="49%">
                                                <div align="center"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Galileo Computing</a> / <a href="https://www.galileo-press.de/openbook/?GPP=opvcs" class="navnav">
                                                      &lt;openbook&gt;</a> / <a href="index.html" class="navnav">Visual C# 2012</a></div>
                                             </td>
                                             <td width="25%">
                                                <div align="right"><a href="1997_14_008.html" class="navnav">vor &gt;&gt; </a></div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                              <tr>
                                 <td width="100%" valign="top">
                                    <table width="100%" border="0" cellpadding="10" cellspacing="0" class="box">
                                       <tbody>
                                          <tr>
                                             <td colspan="2"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="buchtitel">Visual C# 2012</a><span class="autor"> von Andreas Kühnel</span><br><span class="untertitel">Das umfassende Handbuch</span></td>
                                          </tr>
                                          <tr>
                                             <td valign="top" width="211">
                                                <dl>
                                                   <dt><a href="http://www.galileo-press.de/3243/?GPP=opvcs" class="navnav"><img src="common/9783836219976.png" border="0" alt="Buch: Visual C# 2012" title="Buch: Visual C# 2012"></a></dt>
                                                   <dd><br><a href="http://www.galileo-press.de/3243/?GPP=opvcs"><span class="autor"><strong>Visual C# 2012</strong><br><pressinfo><strong>Galileo Computing</strong><br>1402 S., 6., aktualisierte und erweiterte Auflage 2013, geb., mit DVD<br>49,90 Euro, ISBN 978-3-8362-1997-6
                                                            </pressinfo></span></a></dd>
                                                </dl>
                                             </td>
                                             <td width="80%">
                                                <table border="0">
                                                   <tbody>
                                                      <tr>
                                                         <td valign="baseline"><img src="common/pfeil_u.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="3" class="kap"><strong><a href="1997_14_001.html#dodtp7327df50-2f94-44ea-8c62-26cb1aae6058" class="navnav">14 XML</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_001.html#dodtp07187a68-dfb7-40a7-91b0-afc21fd521cb" class="navnav">14.1 Grundlagen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_002.html#dodtpb42214ee-b3f5-4d73-817f-3639853d89ef" class="navnav">14.2 XML-Dokumente</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtpff604111-9e14-48a2-800a-cd2f02e27b6c" class="navnav">14.2.1 Wohlgeformte und gültige XML-Dokumente</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtp51a82937-b931-402f-b14f-46984a41858d" class="navnav">14.2.2 Die Regeln eines wohlgeformten XML-Codes</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtp8c753f06-8b43-4fb2-8b1f-42afb0cab549" class="navnav">14.2.3 Kommentare</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtpd54910a0-738b-4748-9c54-89841861e156" class="navnav">14.2.4 Verarbeitungsanweisungen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtp7265d71d-75b9-4ab1-90bb-bc4df3ffefad" class="navnav">14.2.5 Reservierte Zeichen in XML</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtp8f104cc4-1097-4bfb-9e32-b5cf57542cbb" class="navnav">14.2.6 CDATA-Abschnitte</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_002.html#dodtp76446769-a548-4ee4-8cc0-3360d6191d8b" class="navnav">14.2.7 Namensräume (Namespaces)</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_003.html#dodtpa7fd21b4-6118-4e34-abf9-6c8e86a254f8" class="navnav">14.3 Die Gültigkeit eines XML-Dokuments</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_003.html#dodtp6c4d2d8b-e929-41cf-8976-b40582a112a7" class="navnav">14.3.1 XML Schema Definition (XSD)</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_003.html#dodtpd0a25262-7ebb-487e-bbfe-7098d79a0db1" class="navnav">14.3.2 Ein XML-Dokument mit einem XML-Schema verknüpfen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_003.html#dodtp82a03851-1116-40f2-ab73-24e20b5d7243" class="navnav">14.3.3 Die Struktur eines XML-Schemas</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_004.html#dodtpe0b49d3c-abf9-432a-8241-d5505e5131cc" class="navnav">14.4 Die Klasse »XmlReader«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_004.html#dodtp6bf25c73-1dec-4ce1-ad02-b5489e4bc77a" class="navnav">14.4.1 XML-Dokumente mit einem »XmlReader«-Objekt lesen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_004.html#dodtpce42db2d-78d2-45bf-a2f7-125f90feded7" class="navnav">14.4.2 Validieren eines XML-Dokuments</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_005.html#dodtp08718097-56f3-413f-a7ce-8643de857a9b" class="navnav">14.5 Eigenschaften und Methoden der Klasse »XmlReader«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_006.html#dodtp4f7785d8-1d65-4166-b335-1a184408a7d7" class="navnav">14.6 Die Klasse »XmlWriter«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_006.html#dodtpd714fb91-f540-4477-9747-fabd6b2ed5fa" class="navnav">14.6.1 Die Methoden der Klasse »XmlWriter«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_007.html#dodtp4d3b2cc2-d8ec-4d85-89df-d142034db6a3" class="navh">14.7 Navigation durch XML (XPath)</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_007.html#dodtp9d3d100d-cfeb-450d-b19e-93924d1c7aff" class="navh">14.7.1 Die Klasse »XPathNavigator«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_007.html#dodtp75fdf42f-aceb-406e-805b-9d2ef143de8a" class="navh">14.7.2 XPath-Ausdrücke</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_007.html#dodtp2c8fc977-cc1a-406b-a15a-dd9bd04cf3e4" class="navh">14.7.3 Der Kontextknoten</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_007.html#dodtp8e49b7f9-565b-4bb5-9f24-a95b291e19b7" class="navh">14.7.4 Beispiele mit XPath-Ausdrücken</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_007.html#dodtp34758e9f-d0f9-494d-9932-9569b613f1a7" class="navh">14.7.5 Knotenmengen mit der »Select«-Methode</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_007.html#dodtp9b2ffe27-0785-4313-8a10-73a46deecfa8" class="navh">14.7.6 Auswerten von XPath-Ausdrücken</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_008.html#dodtpf99a38a4-1614-4e58-922d-90b4083a64ef" class="navnav">14.8 Das Document Object Model (DOM)</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtp443a141a-578b-4f6a-bf45-0951aa9b4ef7" class="navnav">14.8.1 Allgemeines</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtp4571bbba-adbd-47eb-a56a-61b9a54dd62b" class="navnav">14.8.2 Arbeiten mit »XmlDocument«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtpcfcd27b1-c0b5-4725-b623-cf053ac9a5f1" class="navnav">14.8.3 »XmlDocument« und »XPathNavigator«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtpfd426dd2-07c5-4235-9b64-ef03ddd0702b" class="navnav">14.8.4 Die Klasse »XmlNode« (Operationen mit Knoten)</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtpceb2c362-9c6a-4968-b4ef-bdd33f31b152" class="navnav">14.8.5 Manipulieren einer XML-Struktur</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtp1cda91d9-998d-4c7c-bd7f-33264b93e96d" class="navnav">14.8.6 Ändern eines Knotens</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_008.html#dodtp502ad8f6-0f64-4dc5-ac2e-5fe96e70e7e4" class="navnav">14.8.7 Löschen in einem XML-Dokument</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_009.html#dodtpd847d330-3ed5-4974-815e-a0a1f1f06c82" class="navnav">14.9 Serialisierung mit »XmlSerializer«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_009.html#dodtp925366af-2e68-4617-baff-d03b0ca76c2b" class="navnav">14.9.1 XML-Serialisierung mit Attributen steuern</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_14_010.html#dodtp935bc17c-e67c-4269-94ff-a84b9ca1839e" class="navnav">14.10 LINQ to XML</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_010.html#dodtp8cb98648-1c46-4ec1-bd6f-f316a80f83ad" class="navnav">14.10.1 Allgemeines</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_010.html#dodtpdadef781-e852-42f2-a72c-53a377ba5796" class="navnav">14.10.2 Die Klassenhierarchie von LINQ to XML</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_010.html#dodtpa4462382-775b-4a28-a141-baf2c8896eb1" class="navnav">14.10.3 Die Klasse »XElement«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_010.html#dodtpf106e4bb-9cbc-4b82-aba8-e6d400fb4f72" class="navnav">14.10.4 Die Klasse »XDocument«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_010.html#dodtp733b0bcb-9828-42dd-81f1-823ad6aa60a3" class="navnav">14.10.5 Navigation im XML-Dokument</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_14_010.html#dodtp904060bd-3c2f-42aa-b3fc-8157d12289bf" class="navnav">14.10.6 Änderungen am XML-Dokument vornehmen</a></strong></td>
                                                      </tr>
                                                   </tbody>
                                                </table>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                    <table width="100%" cellpadding="20" cellspacing="0" border="0" bgcolor="#eeeeee">
                                       <tbody>
                                          <tr>
                                             <td>
                                                <div class="main"><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp4d3b2cc2-d8ec-4d85-89df-d142034db6a3" name="dodtp4d3b2cc2-d8ec-4d85-89df-d142034db6a3"></a><h2 class="t2"><span class="cfett">14.7    </span><span class="cfett"> Navigation durch XML (XPath)</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp9d3d100d-cfeb-450d-b19e-93924d1c7aff"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a></h2><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp9d3d100d-cfeb-450d-b19e-93924d1c7aff" name="dodtp9d3d100d-cfeb-450d-b19e-93924d1c7aff"></a><h3 class="t3"><span class="cfett">14.7.1    </span><span class="cfett"> Die Klasse »XPathNavigator«</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp75fdf42f-aceb-406e-805b-9d2ef143de8a"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp4d3b2cc2-d8ec-4d85-89df-d142034db6a3"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der <span class="clisting">XmlReader</span> ermöglicht nur eine Vorwärtsbewegung durch ein XML-Dokument. In manchen Situationen
                                                      mag das durchaus genügen, aber häufig wird man nach bestimmten Elementen und den von
                                                      Ihnen beschriebenen Daten suchen und dabei wahlfrei navigieren wollen. Hierbei werden
                                                      wir von einem Objekt vom Typ <span class="clisting">XPathNavigator</span> unterstützt, das zum Namensraum <span class="clisting">System.Xml.XPath</span> gehört. Mit einem <span class="clisting">XPathNavigator</span> können Sie zum Beispiel auch rückwärts navigieren und darüber hinaus Suchmuster angeben,
                                                      die ein Filtern der Daten ermöglichen. Diese Suchmuster werden als <span class="cfett">XPath-Ausdrücke</span> bezeichnet. Die <span class="clisting">XPathNavigator</span>-Klasse unterstützt die Funktionen von XPath 2.0.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das hört sich sehr positiv an, ist aber mit einem Nachteil verbunden, denn das ganze
                                                      XML-Dokument muss zuerst in den Speicher geladen werden. Sie müssen also einen Verlust
                                                      an Performance und je nach Größe des XML-Dokuments auch eine vergleichsweise hohe
                                                      Speicherbelastung akzeptieren.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ein <span class="clisting">XPathNavigator</span> kann ausgehend von
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp">einem <span class="clisting">XPathDocument</span>-Objekt oder
                                                      </li>
                                                      <li class="pgp">einem <span class="clisting">XmlDocument</span>-Objekt
                                                      </li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">mit der Methode <span class="clisting">CreateNavigator</span> erstellt werden. Ein <span class="clisting">XPathDocument</span>-Objekt dient nur dem schnellen Einlesen eines XML-Dokuments, die Daten sind schreibgeschützt
                                                      und erlauben keinerlei weitere Verarbeitung. Daten hingegen, die ein <span class="clisting">XmlDocument</span>-Objekt zur Verfügung stellt, können auch verändert werden. Auf die zahlreichen Möglichkeiten,
                                                      die sich hinter <span class="clisting">XmlDocument</span> verbergen, kommen wir im nächsten Kapitel zu sprechen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Um die Vorteile eines <span class="clisting">XPathNavigator</span>-Objekts nutzen zu können, benötigen Sie zuerst ein <span class="clisting">XPathDocument</span>-Objekt (oder alternativ ein <span class="clisting">XmlDocument</span>-Objekt). Dem Konstruktor können Sie den Pfad zu der XML-Datei oder einen Stream übergeben,
                                                      der die XML-Daten liefert. Anschließend rufen Sie die Methode <span class="clisting">CreateNavigator</span> auf, die die Referenz auf ein <span class="clisting">XPathNavigator</span>-Objekt liefert.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">XPathDocument xPathDoc = new XPathDocument(@"D:\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Jetzt können die Methoden des <span class="clisting">XPathNavigator</span>-Objekts zur Navigation des im Speicher befindlichen XML-Dokuments benutzt werden.
                                                      Dabei gilt es, zwei Techniken zu unterscheiden:
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp">Navigation mit den <span class="clisting">Move</span>-Methoden
                                                      </li>
                                                      <li class="pgp">Navigation unter Zuhilfenahme von XPath-Ausdrücken</li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die zahlreichen <span class="clisting">Move</span>-Methoden gestatten die beliebige Navigation durch ein XML-Dokument. Allerdings ist
                                                      der Code insbesondere bei komplexen XML-Strukturen oft nur schwierig nachvollziehbar.
                                                      Greifen Sie auf XPath-Ausdrücke zurück, wird der Code kürzer und hat dabei auch noch
                                                      den Vorteil, nach mehreren Elementen gleichzeitig suchen zu können. Nachteilig dabei
                                                      ist, dass der Einsatz von XPath-Ausdrücken voraussetzt, dass Sie sich zuvor mit der
                                                      Syntax von XPath anfreunden. Eine Einführung dazu erhalten Sie später.
                                                   </p>
                                                   <h4 class="t4"> Navigieren mit den »Move«-Methoden</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="clisting">XPathNavigator</span> verfolgt ein cursorbasiertes Modell, bei dem eine Art Zeiger immer auf einen Knoten
                                                      im XML-Dokument zeigt. Ausgehend von dem aktuellen Knoten, der auch als Kontextknoten
                                                      bezeichnet wird, kann man mit einer der zahlreichen Methoden beliebig durch das Dokument
                                                      navigieren.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">An dieser Stelle alle Methoden und Eigenschaften eines <span class="clisting">XPathNavigator</span>-Objekts vollständig zu beschreiben, würde den Rahmen sprengen. Daher möchte ich mich
                                                      auf ein paar wenige Navigationsmethoden beschränken, um ein Gefühl dafür zu vermitteln,
                                                      welche Möglichkeiten in dieser Klasse stecken.
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 14.9  </span>Die »Move«-Methoden eines »XPathNavigator«-Objekts (Auszug)
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Methode
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveTo</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Dieser Methode wird eine <span class="clisting">XPathNavigator</span>-Instanz übergeben, die auf dem Knoten positioniert ist, zu dem der aktuelle Knoten
                                                                  wechseln soll.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToFirstAttribute</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="pstandard">Verschiebt den <span class="clisting">XPathNavigator</span> beim Überschreiben in einer abgeleiteten Klasse auf das erste Attribut des aktuellen
                                                                  Knotens.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToAttribute</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="pstandard">Verschiebt den <span class="clisting">XPathNavigator</span> zu dem Attribut mit dem angegebenen Namen und Namespace-URI.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToRoot</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt die Position des Cursors auf den Stammknoten. </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToFirst</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt den Cursor auf den ersten nebengeordneten Knoten des aktuellen Knotens.
                                                                  Der Rückgabewert ist <span class="clisting">true</span>, wenn es einen nebengeordneten Knoten gibt, ansonsten <span class="clisting">false</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToNext</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt den Cursor auf den nächsten nebengeordneten Knoten des aktuellen Knotens.
                                                                  Der Rückgabewert ist <span class="clisting">true</span>, wenn es einen nebengeordneten Knoten gibt, ansonsten <span class="clisting">false</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToPrevious</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt den Cursor auf den vorhergehenden nebengeordneten Knoten des aktuellen
                                                                  Knotens. Der Rückgabewert ist <span class="clisting">true</span>, wenn es einen nebengeordneten Knoten gibt, ansonsten <span class="clisting">false</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToChild</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt den Cursor auf den angegebenen untergeordneten Knoten. Der Rückgabewert
                                                                  ist <span class="clisting">true</span>, wenn es den untergeordneten Knoten gibt, ansonsten <span class="clisting">false</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToFirstChild</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt den Cursor auf den ersten untergeordneten Knoten des aktuellen Knotens.
                                                                  Der Rückgabewert ist <span class="clisting">true</span>, wenn es einen untergeordneten Knoten gibt, ansonsten <span class="clisting">false</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToFollowing</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="pstandard">Verschiebt den Cursor auf das Element mit dem angegebenen lokalen Namen oder einen
                                                                  bestimmten <span class="clisting">XPathNodeType</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToParent</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Verschiebt den Cursor auf den übergeordneten Knoten des aktuellen Knotens. Der Rückgabewert
                                                                  ist <span class="clisting">true</span>, wenn die Aktion erfolgreich durchgeführt werden konnte, ansonsten <span class="clisting">false</span>.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Wie Sie durch ein XML-Dokument navigieren, möchte ich Ihnen nun in Einzelschritten
                                                      zeigen. Dabei dient wieder die Datei <span class="ckursiv">Personen.xml</span> als Basis der einzulesenden XML-Struktur. Nachdem Sie sich ein <span class="clisting">XPathNavigator</span>-Objekt mit 
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">XPathDocument xPathDoc = new XPathDocument(@"D:\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">besorgt haben, müssen Sie den Cursor zuerst auf das Stammelement des XML-Dokuments
                                                      positionieren. Dazu bieten sich die Methoden <span class="clisting">MoveToFollowing</span> oder <span class="clisting">MoveToFirstChild</span> an. Der Methode <span class="clisting">MoveToFollowing</span> müssen Sie dabei ausdrücklich den Bezeichner des Stammelements übergeben, gegebenenfalls
                                                      auch noch den Namespace-URI. 
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">navigator.MoveToFollowing("Personen", "");<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Einfacher ist die Handhabung der Methode <span class="clisting">MoveToFirstChild</span>, die parameterlos ist.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">navigator.MoveToFirstChild();<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Damit steht der Cursor auf dem Stammelement <span class="ckursiv">Personen</span>. Um zum ersten untergeordneten Knoten <span class="ckursiv">Person</span> zu navigieren, muss <span class="clisting">MoveToFirstChild</span> ein weiteres Mal aufgerufen werden.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das Element <span class="ckursiv">Person</span> hat mehrere untergeordnete Elemente. Möchte man diese der Reihe nach durchlaufen,
                                                      muss der Cursor zuerst auf das erste untergeordnete, also <span class="ckursiv">Vorname</span> positioniert werden. Das bedeutet bereits den dritten Aufruf der Methode <span class="clisting">MoveToFirstChild</span> hintereinander. Alle nebengeordneten Elemente <span class="ckursiv">Zuname</span>, <span class="ckursiv">Alter</span> und <span class="ckursiv">Adresse</span> erhält man über jeweils einen Aufruf der Methode <span class="clisting">MoveToNext</span>.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Zeigt der Cursor auf einen <span class="ckursiv">Person</span>-Knoten, müssen Sie nicht alle Elemente <span class="ckursiv">Vorname</span>, <span class="ckursiv">Zuname</span> und <span class="ckursiv">Alter</span> abrufen, um <span class="ckursiv">Adresse</span> auszuwerten. Sie können dazu auch die Methode <span class="clisting">MoveToChild</span> bemühen, der Sie den Bezeichner des gewünschten Elements sowie dessen Namespace-URI
                                                      angeben.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">navigator.MoveToChild("Adresse", "http://www.MyNS.de");<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ist das entsprechende Element keinem Namensraum zugeordnet, übergeben Sie eine leere
                                                      Zeichenfolge.
                                                   </p>
                                                   <h4 class="t4"> Beispielprogramm</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sehen wir uns nun ein komplettes Beispiel an, in dem ein XML-Dokument vollständig
                                                      durchlaufen wird. Dabei wird eine rekursive Programmiertechnik benutzt, die alle Knoten
                                                      des Dokuments auswertet. Die Methode <span class="ckursiv">Navigate</span> hat die Aufgabe, durch das Dokument zu navigieren, <span class="ckursiv">WriteNode</span> gibt die Knotenbezeichner und die von ihnen beschriebenen Werte aus. 
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint"><span class="clistingfett">// Beispiel: ..\Kapitel 14\XPathNavigatorSample</span><br></br><span class="clistingfett">static void Main(string[] args) </span>{<br xmlns="">  XPathDocument doc = new XPathDocument(@"..\..\Personen.xml");<br xmlns="">  XPathNavigator navi = doc.<span class="clistingfett">CreateNavigator</span>();<br></br>  // Zum Stammknoten navigieren<br></br>  navi.<span class="clistingfett">MoveToRoot()</span>;<br xmlns="">  Navigate(navi);<br xmlns="">  Console.ReadLine();<br xmlns="">}<br></br>// Methode, die durch die Knoten navigiert<br></br><span class="clistingfett">static void Navigate(XPathNavigator navi) </span>{<br xmlns="">  WriteNode(navi);<br></br>  // Verschiebt den Cursor auf den ersten untergeordneten Knoten <br></br>  if (navi.<span class="clistingfett">MoveToFirstChild()</span>) {<br></br>  // Verschiebt den Cursor zum nächsten nebengeordneten Knoten<br></br>    do {<br xmlns="">      Navigate(navi);<br xmlns="">    } while (navi.<span class="clistingfett">MoveToNext()</span>);<br xmlns="">    navi.<span class="clistingfett">MoveToParent()</span>;<br xmlns="">  }<br xmlns="">}<br></br>// Methode zur Ausgabe an der Konsole<br></br><span class="clistingfett">static void WriteNode(XPathNavigator navi) </span>{<br xmlns="">  switch (navi.NodeType)<br xmlns="">  {<br xmlns="">    case XPathNodeType.Element:<br xmlns="">      if (navi.<span class="clistingfett">HasAttributes</span>) {<br xmlns="">        Console.Write("&lt;" + navi.Name + " ");<br xmlns="">        navi.<span class="clistingfett">MoveToFirstAttribute()</span>;<br xmlns="">        do {<br xmlns="">          Console.Write(navi.Name + "=" + navi.Value + " ");<br xmlns="">        } while (navi.<span class="clistingfett">MoveToNextAttribute()</span>);<br xmlns="">        Console.WriteLine("&gt;");<br xmlns="">        navi.<span class="clistingfett">MoveToParent()</span>;<br xmlns="">      }<br xmlns="">      else {<br xmlns="">        Console.WriteLine("&lt;" + navi.Name + "&gt;");<br xmlns="">      }<br xmlns="">      break;<br xmlns="">    case XPathNodeType.Text:<br xmlns="">      Console.WriteLine(navi.Value);<br xmlns="">      break;<br xmlns="">  }<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.35  </span>Beispielprogramm mit der Klasse »XPathNavigator«
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp75fdf42f-aceb-406e-805b-9d2ef143de8a" name="dodtp75fdf42f-aceb-406e-805b-9d2ef143de8a"></a><h3 class="t3"><span class="cfett">14.7.2    </span><span class="cfett"> XPath-Ausdrücke</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp2c8fc977-cc1a-406b-a15a-dd9bd04cf3e4"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp49758d54-9e49-425b-984b-a4bcdc227b6f"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">XPath ist eine Entwicklung des W3-Konsortiums und dient dazu, nach einem oder mehreren
                                                      Knoten in einer XML-Struktur zu suchen. XPath wird normalerweise im Zusammenhang mit
                                                      anderen Standards eingesetzt und stellt eine XML-Struktur als einen Baum dar, der
                                                      aus Knoten besteht. Die Lokalisierung eines oder mehrerer Knoten ähnelt der Notation
                                                      einer URL &#8211; vermutlich stammt auch daher der Name XPath. Für die effiziente Arbeit
                                                      mit XML ist XPath unabdingbar. Daher wollen wir uns in diesem Abschnitt auch ein wenig
                                                      mit der XPath-Spezifikation beschäftigen. Dabei auf jedes Detail einzugehen, würde
                                                      den Rahmen sprengen. Wenn Sie aber über diesen Abschnitt hinaus nach weiteren Informationen
                                                      suchen, finden Sie diese unter <span class="ckursiv">http://www.w3.org/TR/xpath/</span>.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Aber wie sieht ein XPath-Ausdruck aus? Nehmen wir an, Sie interessieren sich für alle
                                                      Zunamen in dem XML-Dokument, das durch die Datei <span class="ckursiv">Personen.xml</span> beschrieben wird. Mit dem folgenden Codefragment können Sie das bereits erreichen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">XPathDocument xPathDoc = new XPathDocument(@"..\..\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<br xmlns="">navigator.MoveToFirstChild();<br xmlns="">XPathNodeIterator iterator = navigator.Select("<span class="clistingfett">//Zuname</span>");<br xmlns="">while (iterator.MoveNext())<br xmlns="">{<br xmlns="">  Console.WriteLine(iterator.Current.Value);<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.36  </span>Einfache Navigation mit XPath
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Hätten Sie nur die Methoden der Klasse <span class="clisting">XPathNavigator</span> benutzt, wäre der Code deutlich aufwendiger ausgefallen. Der XPath-Ausdruck <span class="ckursiv">//Zuname</span> vereinfacht den Zugriff auf die Zunamen sehr deutlich.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Wie bereits erwähnt, stellt XPath eine XML-Dokumentstruktur als Baum dar. Dabei gibt
                                                      es verschiedene Knotentypen, zum Beispiel Elementknoten, Textknoten oder Attributknoten.
                                                      Die Lokalisierung der verschiedenen Ebenen besteht aus maximal drei Teilen:
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp">eine Achse, die zum Navigieren innerhalb der XML-Struktur dient</li>
                                                      <li class="pgp">eine Knotenprüfung, um weitere Kriterien zu definieren; damit lassen sich bestimmte
                                                         Knoten selektieren
                                                      </li>
                                                      <li class="pgp">einem Prädikat, um die selektierten Knoten weiter filtern zu können</li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Angaben von Achse und Knotenprüfung sind vorgeschrieben, während ein Prädikat
                                                      optional ist. Die allgemeine Syntax eines XPath-Ausdrucks lautet:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">achse::knotenprüfung[prädikat]<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Beschreibt ein XPath-Ausdruck ein Prädikat, dann wird dieses in eckige Klammern eingeschlossen.</p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp2c8fc977-cc1a-406b-a15a-dd9bd04cf3e4" name="dodtp2c8fc977-cc1a-406b-a15a-dd9bd04cf3e4"></a><h3 class="t3"><span class="cfett">14.7.3    </span><span class="cfett"> Der Kontextknoten</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp8e49b7f9-565b-4bb5-9f24-a95b291e19b7"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp75fdf42f-aceb-406e-805b-9d2ef143de8a"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das Resultat einer XPath-Abfrage hängt davon ab, von wo die Suche gestartet wird.
                                                      Startet die Suche beim Wurzelelement, kann das Ergebnis ein ganz anderes sein, als
                                                      würde die Suche bei einem Unterelement beginnen. Daher ist das Startelement von ganz
                                                      wesentlicher Bedeutung. XPath verwendet das Konzept eines sogenannten <span class="cfett">Kontextknotens</span>. Dieser Kontextknoten ist der aktuelle Knoten, an dem die Suche gestartet wird.
                                                   </p>
                                                   <h4 class="t4"> Die Achsen</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Bei der Ausführung einer XPath-Abfrage kann eine bestimmte Richtung vorgeschrieben
                                                      werden. Diese wird als <span class="cfett">Achse</span> bezeichnet. Eine Analogie findet sich im Dateisystem, denn Sie können beispielsweise
                                                      mit »<span class="clisting">..</span>« zum übergeordneten Verzeichnis wechseln.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Da einige Achsen sehr häufig benötigt werden, besitzen sie eine Abkürzung. In der
                                                      folgenden Tabelle sind die wichtigsten Achsen beschrieben.
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 14.10  </span>Achsen in XPath-Ausdrücken
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Achse
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">attribute</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Hiermit werden die Attribute des Kontextknotens bestimmt. (Abkürzung: <span class="clisting">@</span>)
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">child</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Mit dieser Achse werden die dem Kontextknoten untergeordneten Elemente (Nachkommen)
                                                                  beschrieben.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">descendant</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Irgendein untergeordnetes Element des Kontextknotens. Dabei kann es sich auch um einen
                                                                  Nachkommen über zwei oder mehr Ebenen handeln. 
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">descendant-or-self</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Wie <span class="clisting">descendant</span>, jedoch unter Einbeziehung des Kontextknotens. (Abkürzung: <span class="clisting">//</span>)
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">following</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Mit dieser Achse werden die Knoten angesprochen, die sich auf der Ebene des Kontextknotens
                                                                  befinden und diesem nachfolgen. Zu der Ergebnismenge gehören auch die untergeordneten
                                                                  Elemente der gefundenen Knoten. 
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">parent</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Das dem Kontextknoten übergeordnete Element. (Abkürzung: <span class="clisting">..</span>)
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">preceding</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Vorherige Knoten des Kontextknotens auf gleicher Ebene, einschließlich der ihnen untergeordneten
                                                                  Knoten.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">In XPath steht das Pfad-Trennzeichen »/« für tatsächliche Namen von Knoten. Beginnt
                                                      ein XPath-Ausdruck nicht mit »<span class="clisting">/</span>« oder »<span class="clisting">//</span>«, beginnt die Suche immer an der aktuellen Cursorposition. Die Suche beschränkt sich
                                                      dann auf die Elemente des Teils der XML-Struktur, der an der Cursorposition beginnt.
                                                   </p>
                                                   <h4 class="t4"> Knotenprüfungen</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ein weiteres Kriterium zur Filterung eines Elements können Sie nach der Angabe der
                                                      Achse festlegen. Es handelt sich um die Knotenprüfung, die anhand der Achse eine Auswahl
                                                      der zu selektierenden Elemente trifft. Die Angabe der Prüfung kann direkt der Elementname
                                                      sein.
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 14.11  </span>Knotenprüfungen in XPath-Ausdrücken
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Knotentyp
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">node()</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Es werden alle Knoten, auch unter Einbeziehung von Namensraum- und Attributsknoten,
                                                                  ausgewählt.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">comment()</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Auswahl eines Kommentarknotens.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">text()</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Auswahl von Knoten, die einen Text enthalten.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">processing-instruction()</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Auswahl der Prozessoranweisungen im XML-Dokument.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <h4 class="t4"> Prädikate</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Auf allen Knoten, die die Ergebnismenge nach der Achsenbestimmung und der Knotenprüfung
                                                      bilden, können Sie spezielle Prädikate anwenden, um die selektierten Knoten weiter
                                                      zu filtern:
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp"><span class="cfett">Logische Operatoren</span>: <span class="clisting">or</span>, <span class="clisting">and</span>, <span class="clisting">!</span>, <span class="clisting">&lt;</span>, <span class="clisting">&gt;</span>, <span class="clisting">&lt;=</span>, <span class="clisting">&gt;=</span>, <span class="clisting">=</span>, <span class="clisting">!=</span></li>
                                                      <li class="pgp"><span class="cfett">Arithmetische Operatoren</span>: <span class="clisting">+</span>, <span class="clisting">-</span>, <span class="clisting">div</span>, <span class="clisting">*</span>, <span class="clisting">mod</span></li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Da die Zeichen »&lt;« und »&gt;« in XML eine besondere Bedeutung haben, müssen Sie sie durch
                                                      <span class="clisting">&amp;lt;</span> sowie <span class="clisting">&amp;gt;</span> ersetzen.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp8e49b7f9-565b-4bb5-9f24-a95b291e19b7" name="dodtp8e49b7f9-565b-4bb5-9f24-a95b291e19b7"></a><h3 class="t3"><span class="cfett">14.7.4    </span><span class="cfett"> Beispiele mit XPath-Ausdrücken</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp34758e9f-d0f9-494d-9932-9569b613f1a7"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp4896bfe9-e595-44f4-a73e-4d9ff76cbdd5"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Nachfolgend zeige ich Ihnen einige XPath-Ausdrücke und deren Ergebnismenge. Alle Beispiele
                                                      basieren auf einem XML-Dokument, in dem insgesamt vier <span class="ckursiv">Person</span>-Elemente definiert sind und zusätzlich noch das Element <span class="ckursiv">Mitarbeiter</span>. Das Stammelement lautet auch hier <span class="ckursiv">Personen</span>.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">&lt;Personen&gt;<br xmlns="">  &lt;Person&gt;<br xmlns="">    &lt;Vorname&gt;Manfred&lt;/Vorname&gt;<br xmlns="">    &lt;Zuname&gt;Fischer&lt;/Zuname&gt;<br xmlns="">    &lt;Alter&gt;45&lt;/Alter&gt;<br xmlns="">    &lt;Adresse Ort="Bonn" Strasse="Neuestr.34"&gt;&lt;/Adresse&gt;<br xmlns="">  &lt;/Person&gt;<br xmlns="">  [...]<br xmlns="">  &lt;Mitarbeiter&gt;<br xmlns="">    &lt;Vorname&gt;Peter&lt;/Vorname&gt;<br xmlns="">    &lt;Zuname&gt;Goldbach&lt;/Zuname&gt;<br xmlns="">    &lt;Position&gt;Chef&lt;/Position&gt;<br xmlns="">  &lt;/Mitarbeiter&gt;<br xmlns="">&lt;/Personen&gt;<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.37  </span>Zugrunde liegendes XML-Dokument für XPath-Ausdrücke
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="cfett">Beispiel 1:</span> Die Auswertung des folgenden Positionspfades liefert alle <span class="ckursiv">Person</span>- und <span class="ckursiv">Mitarbeiter</span>-Elemente, einschließlich der den Elementen <span class="ckursiv">Person</span> und <span class="ckursiv">Mitarbeiter</span> untergeordneten Elemente, jedoch ohne die Attribute. In der Ergebnisliste steht nur
                                                      ein Gesamtergebnis. Das Ergebnis ist unabhängig von der Cursorposition.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Personen<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Achse »<span class="clisting">//</span>« ist sehr nützlich, um Elemente unabhängig von ihrer Position in der Struktur zu
                                                      finden.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="cfett">Beispiel 2:</span> Zum gleichen Ergebnis führt auch der Ausdruck
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">/Personen<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Zu keinem Ergebnis führt jedoch die Auswertung des folgenden Aufrufs, da hier die
                                                      Angabe des Stammelements fehlt:
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="clisting">/Person</span> 
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Anders hingegen das nächste Beispiel. Der Ausdruck beschreibt alle <span class="ckursiv">Person</span>-Elemente, unabhängig von deren Position innerhalb der XML-Struktur. In der Ergebnisliste
                                                      steht für jede Person ein separates Resultat. Da das XML-Dokument vier Personen beschreibt,
                                                      liegen somit auch vier Teilergebnisse vor. 
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Person<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Möchten Sie vielleicht auf ein bestimmtes <span class="ckursiv">Person</span>-Element zugreifen, dessen Position Sie im XML-Dokument kennen? Der nächste XPath-Ausdruck
                                                      liefert das dritte <span class="ckursiv">Person</span>-Element zurück.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Person[3]<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">XPath unterstützt auch Platzhalter. Der folgende Ausdruck wählt alle Elemente aus,
                                                      die dem Stammelement <span class="ckursiv">Personen</span> untergeordnet sind. Es liegen auch hier fünf Resultate in der Ergebnismenge vor,
                                                      da sowohl <span class="ckursiv">Person</span> als auch <span class="ckursiv">Mitarbeiter</span> ausgewertet werden. Besonders sinnvoll ist der Ausdruck, wenn dem Stammelement mehrere
                                                      verschiedene Elemente untergeordnet sind und alle in der Ergebnismenge stehen sollen.
                                                      
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">/Personen/*<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Den Platzhalter können Sie auch angeben, um auf die Attribute des Elements <span class="ckursiv">Adresse</span> zuzugreifen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">/Personen/Person/Adresse/@*<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Interessieren hingegen nur die Werte, die durch das Attribut <span class="ckursiv">Ort</span> beschrieben werden, geben Sie den Attributsbezeichner anstelle des Platzhalters an.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">/Personen/Person/Adresse/@Ort<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Nehmen wir nun an, der Positionscursor zeige auf das erste Element <span class="ckursiv">Person</span> in der XML-Struktur. Mit dem XPath-Ausdruck
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">Vorname<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">wird als Ergebnis <span class="ckursiv">Manfred</span> ausgegeben. Wird explizit keine Achse angegeben, gilt <span class="clisting">child</span> als Vorgabe. Somit führt der gezeigte Ausdruck zum gleichen Ergebnis wie
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">child::Vorname<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Hätte der Cursor eine andere Position eingenommen, wäre die Ergebnismenge leer.</p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Unabhängig von der Cursorposition wird der nächste XPath-Ausdruck alle Vornamen ausgeben,
                                                      da er gleichbedeutend mit dem XPath-Ausdruck <span class="clisting">Vorname</span> ist:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//child::Vorname<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Mit</p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">/child::Vorname<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">bleibt die Ergebnismenge jedoch leer.</p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Mit optionalen Prädikaten lassen sich Ergebnismengen weiter filtern. Sie sind Teil
                                                      des Positionspfades, der in eckigen Klammern erscheint. Der nächste Ausdruck verwendet
                                                      ein Prädikat, um die Auswahl der <span class="ckursiv">Person</span>-Elemente auf die Personen einzugrenzen, deren Alter größer 40 ist.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Person[Alter &gt; 40]<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sehr ähnlich wird mit dem folgenden Ausdruck gefiltert. Hierbei interessieren uns
                                                      alle Personen, die in <span class="ckursiv">Bonn</span> wohnen. Da der <span class="ckursiv">Ort</span> als Attribut definiert ist, muss auf den Attributinhalt zugegriffen werden.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Person/Adresse[@Ort = 'Bonn']<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Prädikate dürfen gemäß XPath-Spezifikation auch mit <span class="clisting">and</span> oder <span class="clisting">or</span> verknüpft werden. Im folgenden XPath-Ausdruck werden die beiden zuvor gezeigten Ausdrücke
                                                      benutzt, um alle <span class="ckursiv">Person</span>-Elemente zu finden, die sowohl älter als 40 sind als auch in Bonn wohnen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Person[Alter &gt; 40 and Adresse[@Ort = 'Bonn']]<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">XPath unterstützt integrierte Funktionen, die häufig in Prädikaten verwendet werden.
                                                      Die Auswertung des folgenden Ausdrucks ergibt alle <span class="ckursiv">Person</span>-Elemente, deren Vorname mit dem Buchstaben »P« beginnt.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Person[starts-with(Vorname, 'P')]<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Zum Abschluss der XPath-Beispiele möchte ich Ihnen noch zeigen, wie der Ausdruck lauten
                                                      muss, um nach allen Personen innerhalb der XML-Struktur zu suchen, deren Zuname »Schmidt«
                                                      oder »Meier« lautet.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">//Zuname[text()='Meier' or text()='Schmidt']<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die bis hier gezeigten Beispiele können vielleicht einen Eindruck darüber vermitteln,
                                                      wie mächtig XPath-Ausdrücke formuliert werden können. Hier alle Möglichkeiten zu zeigen,
                                                      ist aus Platzgründen nicht möglich. Für das weitere Vorgehen und das Verständnis der
                                                      folgenden Beispiele reichen die Ausführungen aber aus. Wenn Sie intensiver in das
                                                      Thema XPath einsteigen wollen, empfiehlt es sich, einen Blick in die Originalspezifikation
                                                      zu werfen, deren Link Sie am Anfang des Kapitels finden.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp34758e9f-d0f9-494d-9932-9569b613f1a7" name="dodtp34758e9f-d0f9-494d-9932-9569b613f1a7"></a><h3 class="t3"><span class="cfett">14.7.5    </span><span class="cfett"> Knotenmengen mit der »Select«-Methode</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp9b2ffe27-0785-4313-8a10-73a46deecfa8"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp8e49b7f9-565b-4bb5-9f24-a95b291e19b7"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">In Abschnitt 14.7.1 haben Sie gesehen, wie Sie mit den Methoden der Klasse <span class="clisting">XPathNavigator</span> durch die Struktur einer XML-Vorlage navigieren können. Mit den Kenntnissen von XPath-Ausdrücken
                                                      ausgestattet lässt sich ein <span class="clisting">XPathNavigator</span>-Objekt aber noch effektiver einsetzen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Um einen XPath-Ausdruck gegen ein XML-Dokument abzusetzen, steht Ihnen die Methode
                                                      <span class="clisting">Select</span> zur Verfügung. Das Ergebnis des Methodenaufrufs ist eine Menge von Knoten, die von
                                                      einem <span class="clisting">XPathNodeIterator</span>-Objekt beschrieben werden. Der <span class="clisting">XPathNodeIterator</span> ist zunächst auf dem Kontextknoten positioniert, der Ausgangspunkt der XPath-Abfrage
                                                      ist. Um zum ersten Knoten in der Ergebnismenge zu gelangen, muss daher zuerst <span class="clisting">MoveNext</span> auf das Iterator-Objekt aufgerufen werden. <span class="clisting">MoveNext</span> eignet sich sehr gut, um in einer Schleife eingesetzt zu werden, da der Rückgabewert
                                                      <span class="clisting">true</span> ist, falls noch ein weiterer Knoten in der Ergebnismenge vorliegt.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">XPathDocument xPathDoc = new XPathDocument(@"C:\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<br xmlns="">XPathNodeIterator iter = navigator.Select("//Person");<br xmlns="">while (iter.MoveNext()) {<br xmlns="">  Console.WriteLine(iter.Current.Value);<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.38  </span>Navigieren zum ersten Knoten mit »MoveNext«
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Eigenschaft <span class="clisting">Current</span> des Iterators ist schreibgeschützt und liefert ein neues <span class="clisting">XPathNavigator</span>-Objekt, das auf das aktuelle XML-Element in der Ergebnismenge zeigt:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">public XPathNavigator Current {get;}<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="clisting">Current</span> ist nicht nur wichtig für die Auswertung des gefundenen Knotens, sondern kann darüber
                                                      hinaus auch Ausgangspunkt für weitere Suchoperationen sein. 
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das <span class="clisting">XPathNodeIterator</span>-Objekt hat neben <span class="clisting">Current</span> noch zwei weitere interessante Eigenschaften: <span class="clisting">Count</span> und <span class="clisting">CurrentPosition</span>. <span class="clisting">Count</span> liefert die Anzahl der Knoten in der Ergebnismenge und <span class="clisting">CurrentPosition</span> den Index der aktuellen Position in der Ergebnismenge. Aber Vorsicht, denn der Index
                                                      ist nicht 0-basiert, sondern 1-basiert. Der Index 0 gibt nämlich an, dass keine Knoten
                                                      ausgewählt sind.
                                                   </p>
                                                   <h4 class="t4"> Ändern des Kontextknotens</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das <span class="clisting">XPathNavigator</span>-Objekt, auf das die <span class="clisting">Select</span>-Methode aufgerufen worden ist, ändert seine Position auch dann nicht, wenn die Ergebnismenge
                                                      durchlaufen wird. Der Kontextknoten bleibt also gleich. Wenn der XPath-Ausdruck nicht
                                                      mit »<span class="clisting">/</span>« oder »<span class="clisting">//</span>« beginnt, beginnt die Suche nach den Elementen an der aktuellen Cursorposition des
                                                      <span class="clisting">XPathNavigator</span>-Objekts. 
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Um die Cursorposition auf eines der Suchergebnisse zu setzen, können Sie anstatt der
                                                      Methode <span class="clisting">Select</span> die Methode <span class="clisting">SelectSingleNode</span> des <span class="clisting">XPathNavigator</span>-Objekts einsetzen. Der Rückgabewert ist ein neues <span class="clisting">XPathNavigator</span>-Objekt, das Sie der <span class="clisting">MoveTo</span>-Methode übergeben.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">bool result = navigator.MoveTo(navigator.SelectSingleNode("XPath-Ausdruck"));<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der Aufruf liefert <span class="clisting">true</span>, wenn die Position des Navigators verschoben werden konnte, bei <span class="clisting">false</span> bleibt die Cursorposition unverändert.
                                                   </p>
                                                   <h4 class="t4"> Weitere »Select«-Methoden</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Neben <span class="clisting">Select</span> gibt es mit 
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp"><span class="clisting">SelectAncestors</span></li>
                                                      <li class="pgp"><span class="clisting">SelectChildren</span></li>
                                                      <li class="pgp"><span class="clisting">SelectDescendants</span></li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">noch drei weitere Varianten zur Filterung von XML-Elementen. <span class="clisting">SelectAncestors</span> wählt alle übergeordneten Knoten des aktuellen Knotens aus, <span class="clisting">SelectChildren</span> alle <span class="cfett">direkt</span> untergeordneten Knoten und <span class="clisting">SelectDescendants</span> ausnahmslos alle untergeordneten Knoten. Allen drei genannten Methoden können Sie
                                                      bestimmte Kriterien für die Filterung übergeben: Entweder Sie geben den Namen des
                                                      gesuchten Elements an oder den Knotentyp (<span class="clisting">XmlNodeType</span>).
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das folgende Beispiel zeigt, wie die genannten <span class="clisting">Select</span>-Methoden benutzt werden können. Als Grundlage dazu dient uns die Datei <span class="ckursiv">Personen.xml</span>, die jedoch um das zusätzliche Element <span class="ckursiv">Geschlecht</span> ergänzt worden ist, das <span class="ckursiv">Zuname</span> untergeordnet ist.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">&lt;Person&gt;<br xmlns="">  &lt;Vorname&gt;Manfred&lt;/Vorname&gt;<br xmlns="">  &lt;Zuname&gt;Fischer<br xmlns="">    &lt;Geschlecht&gt;Männlich&lt;/Geschlecht&gt;<br xmlns="">  &lt;/Zuname&gt;<br xmlns="">  &lt;Alter&gt;45&lt;/Alter&gt;<br xmlns="">  &lt;Adresse Ort="Bonn" Strasse="Neuestr.34"&gt;&lt;/Adresse&gt;<br xmlns="">&lt;/Person&gt;<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.39  </span>XML-Dokument für das Listing 14.40
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Hier nun der Code des Beispielprogramms:</p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint"><span class="clistingfett">// Beispiel: ..\Kapitel 14\SelectSample</span><br></br><span class="clistingfett">static void Main(string[] args) </span>{<br xmlns="">  string trenner = new string('-', 45);<br xmlns="">  XPathDocument doc = new XPathDocument("..\\..\\Personen.xml");<br xmlns="">  XPathNavigator navigator = doc.CreateNavigator();<br xmlns="">  navigator.MoveToChild("Personen","");<br xmlns="">  navigator.MoveToChild("Person", "");<br></br>  // Alle untergeordneten Elemente einer 'Person'<br></br>  XPathNodeIterator descendant = <br xmlns="">  navigator.<span class="clistingfett">SelectDescendants</span>("", "", false);<br xmlns="">  Console.WriteLine("Alle untergeordneten Elemente von 'Person':");<br xmlns="">  Console.WriteLine(trenner);<br xmlns="">  while (descendant.MoveNext()) {<br xmlns="">    Console.WriteLine(descendant.Current.Name);<br xmlns="">  }<br></br>  // Alle direkt untergeordneten Elemente einer 'Person'<br></br>  XPathNodeIterator children = navigator.<span class="clistingfett">SelectChildren</span>("", "");<br xmlns="">  Console.WriteLine("\nDirekt untergeordnete Elemente von 'Person':");<br xmlns="">  Console.WriteLine(trenner);<br xmlns="">  while (children.MoveNext()) {<br xmlns="">    Console.WriteLine(children.Current.Name);<br xmlns="">  }<br></br>  // Die übergeordneten Elemente von 'Zuname'<br></br>  navigator.MoveToChild("Zuname", "");<br xmlns="">  XPathNodeIterator ancestors = navigator.<span class="clistingfett">SelectAncestors</span>("", "", false);<br xmlns="">  Console.WriteLine("\nÜbergeordnete Elemente von 'Zuname':");<br xmlns="">  Console.WriteLine(trenner);<br xmlns="">  while (ancestors.MoveNext()) {<br xmlns="">    Console.WriteLine(ancestors.Current.Name);<br xmlns="">  }<br></br>  Console.ReadLine();<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.40  </span>Das Beispielprogramm »SelectSample«
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Als Grundlage der <span class="clisting">Select</span>-Methoden wird jeweils die Überladung benutzt, die im ersten Parameter den Knotenbezeichner
                                                      erwartet. Gibt man eine leere Zeichenfolge an, werden der Ergebnismenge alle gefundenen
                                                      Knoten hinzugefügt. Der zweite Parameter erwartet den Namespace-URI. Da in unserem
                                                      XML-Dokument kein Namespace definiert ist, wird hier eine leere Zeichenfolge übergeben.
                                                      Der dritte Parameter der Methoden <span class="clisting">SelectAncestors</span> und <span class="clisting">SelectDescendants</span> schließlich erwartet einen booleschen Wert, der angibt, ob der aktuelle Knoten (der
                                                      Kontextknoten) in die Ergebnismenge aufgenommen werden soll. In beiden Fällen wurde
                                                      unter Angabe von <span class="clisting">false</span> darauf verzichtet.
                                                   </p>
                                                   <p><a href="bilder/14_06.png" rel="lightbox" title="Ergebnisliste des Beispiels »SelectSample«"><img class="bild" border="1" src="bilderklein/klein14_06.png" alt="Abbildung"></a></p>
                                                   <p class="pbildunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Abbildung 14.6  </span>Ergebnisliste des Beispiels »SelectSample«
                                                   </p>
                                                   <h4 class="t4"> Kompilieren von XPath-Ausdrücken</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Bei der Filterung von Knoten mit XPath-Ausdrücken führt der Parser immer wieder eine
                                                      Analyse und Optimierung der Abfrage durch. Bei Abfragen, die wiederholt verwendet
                                                      werden, bedeutet das eine Leistungseinbuße. Um dem zu begegnen, besitzen die Methoden,
                                                      die einen XPath-Ausdruck akzeptieren, auch eine Überladung für einen kompilierten
                                                      Ausdruck, der durch <span class="clisting">XPathExpression</span> dargestellt wird. Dazu zählt auch <span class="clisting">Select</span>. 
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ein <span class="clisting">XPathExpression</span>-Objekt erhalten Sie als Rückgabewert der statischen Methode <span class="clisting">Compile</span> der Klasse <span class="clisting">XPathExpression</span>.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">public static XPathExpression Compile(string xpath)<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der Einsatz eines kompilierten XPath-Ausdrucks kann insbesondere bei komplexen Ausdrücken
                                                      eine durchaus deutliche Steigerung der Abfrageleistung bringen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">XPathDocument xPathDoc = new XPathDocument(@"D:\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<span class="clistingfett"><br xmlns="">XPathExpression xpathExpr = XPathExpression.Compile("//Person");</span><br xmlns="">XPathNodeIterator iter = navigator.Select(xpathExpr);<br xmlns="">while (iter.MoveNext()) {<br xmlns="">  Console.WriteLine(iter.Current.Value);<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.41  </span>Kompilierter XPath-Ausdruck
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp9b2ffe27-0785-4313-8a10-73a46deecfa8" name="dodtp9b2ffe27-0785-4313-8a10-73a46deecfa8"></a><h3 class="t3"><span class="cfett">14.7.6    </span><span class="cfett"> Auswerten von XPath-Ausdrücken</span><a xmlns="http://www.w3.org/1999/xhtml" href="#"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp686324f2-4587-4fe0-914b-10a024278599"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <h4 class="t4"> Die Methode »Evaluate«</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Bisher habe ich Ihnen nur gezeigt, wie Sie mit XPath-Ausdrücken eine auf Knoten basierende
                                                      Ergebnismenge auswerten können. XPath-Ausdrücke ermöglichen es aber auch, Berechnungen
                                                      auszuführen. Dabei hilft die Methode <span class="clisting">Evaluate</span> des <span class="clisting">XPathNavigator</span>-Objekts weiter:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">public virtual Object Evaluate(string xpath)<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Es gibt weitere Überladungen, die auch ein <span class="clisting">XPathExpression</span>- oder <span class="clisting">XPathNodeIterator</span>-Objekt entgegennehmen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Dazu sofort ein Beispiel. Angenommen, Sie interessieren sich für das Durchschnittsalter
                                                      aller Personen, die in der Datei <span class="ckursiv">Personen.xml</span> beschrieben werden. Der XPath-Ausdruck dazu lautet:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">sum(//Alter) div count(//Alter)<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Funktion <span class="clisting">sum</span> liefert die Summe der in der Ergebnismenge <span class="ckursiv">//Alter</span> enthaltenen Werte, und <span class="clisting">count</span> liefert die Anzahl der zurückgegebenen Ergebnisse aus der Abfrage <span class="ckursiv">//Alter</span>. Die Funktion <span class="clisting">div</span> ist der Divisionsoperator.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">string xPath = "sum(//Alter) div count(//Alter)";<br xmlns="">XPathDocument xPathDoc = new XPathDocument(@"D:\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<br xmlns="">double result = Convert.ToDouble(navigator.<span class="clistingfett">Evaluate</span>(xPath));<br xmlns="">Console.WriteLine("Durchschnittsalter = {0}",result);<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.42  </span>Die Methode »Evaluate«
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Da der Rückgabewert von <span class="clisting">Evaluate</span> vom Typ <span class="clisting">Object</span> ist, muss noch in den passenden Typ konvertiert werden.
                                                   </p>
                                                   <h4 class="t4"> Die Methode »Matches«</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Mit der Methode <span class="clisting">Matches</span> können Sie feststellen, ob der aktuelle Knoten des <span class="clisting">XPathNavigators</span> einem bestimmten XPath-Ausdruck entspricht. 
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">public virtual bool Matches(string xpath)<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="clisting">Matches</span> akzeptiert auch einen kompilierten XPath-Ausdruck vom Typ <span class="clisting">XPathExpression</span>.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Im folgenden Codefragment wird untersucht, ob der Cursor das <span class="ckursiv">Personen</span>-Element beschreibt. Der Rückgabewert ist in diesem Fall <span class="clisting">true</span>, da zuvor mit <span class="clisting">MoveToFirstChild</span> zum Stammelement des XML-Dokuments navigiert wird.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">XPathDocument xPathDoc = new XPathDocument(@"D:\Personen.xml");<br xmlns="">XPathNavigator navigator = xPathDoc.CreateNavigator();<br xmlns="">navigator.MoveToFirstChild();<br xmlns="">Console.WriteLine(navigator.<span class="clistingfett">Matches</span>("//Personen").ToString());<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.43  </span>Die Methode »Matches«
                                                   </p>
                                                   <h4 class="t4"> Namensräume</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">In nahezu jedem XML-Dokument wird die Technik der Namensräume benutzt, um Elemente
                                                      eindeutig zuordnen zu können. <span class="clisting">XPathNavigator</span> unterstützt mit mehreren Eigenschaften und Methoden die Namensräume. 
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 14.12  </span>Eigenschaften und Methoden, die die Namespaces betreffen
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Eigenschaft/Methode
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">LocalName</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Eigenschaft) Ruft den Bezeichner des aktuellen Knotens ohne Namespace-Präfix ab.
                                                                  Die ähnliche Eigenschaft <span class="clisting">Name</span> liefert den Bezeichner samt Präfix.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">NamespaceURI</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Eigenschaft) Ruft den Namespace-URI des aktuellen Knotens ab.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">Prefix</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Eigenschaft) Ruft das Namespace-Präfix des aktuellen Knotens ab.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">GetNamespacesInScope</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Methode) Gibt alle im Gültigkeitsbereich befindlichen Namespaces des aktuellen Knotens
                                                                  zurück.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">LookupNamespace</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Methode) Ruft den Namespace-URI für das angegebene Präfix ab.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">LookupPrefix</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Methode) Ruft das Namespace-Präfix für das angegebene <br xmlns="">Präfix ab.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToFirstNamespace</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Methode) Verschiebt den <span class="clisting">XPathNavigator</span> auf den ersten Namespace-Knoten des aktuellen Knotens.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">MoveToNextNamespace</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">(Methode) Verschiebt den <span class="clisting">XPathNavigator</span> auf den nächsten Namespace-Knoten des aktuellen Knotens.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Eigenschaften <span class="clisting">LocalName</span>, <span class="clisting">NamespaceURI</span> und <span class="clisting">Prefix</span> sind schon vom <span class="clisting">XmlReader</span> her bekannt und werden auf dem aktuellen Knoten ausgewertet. <span class="clisting">LookupNamespace</span> und <span class="clisting">LookupPrefix</span> liefern Informationen, die das gesamte XML-Dokument betreffen, aber nur auf ein Präfix
                                                      oder einen Namensraum bezogen sind. 
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Methode <span class="clisting">GetNamespacesInScope</span> müssen wir uns noch genauer ansehen, da ihr Einsatz etwas komplexer ist. Die Methode
                                                      liefert alle Namespaces, die sich im Gültigkeitsbereich des aktuellen Knotens befinden.
                                                      Ist der Navigator auf das Stammelement positioniert, handelt es sich folgerichtig
                                                      um alle Namespaces des XML-Dokuments. Der Rückgabewert der Methode ist eine generische
                                                      Collection, in der die einzelnen Elemente über ein Key-Value-Paar beschrieben werden.
                                                      Jeder Namespace-Eintrag wird in der Collection durch den Typ <span class="clisting">KeyValuePair&lt;string, string&gt;</span> beschrieben.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sie müssen <span class="clisting">GetNamespacesInScope</span> mitteilen, ob die gelieferte Liste gefiltert werden soll. Dazu übergeben Sie der
                                                      Methode ein Argument vom Typ der Enumeration <span class="clisting">XmlNamespaceScope</span>. 
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 14.13  </span>Konstanten der Enumeration »XmlNamespaceScope«
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Enumerationswert
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">All</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Liefert alle Namespaces, die sich im Gültigkeitsbereich des aktuellen Knotens befinden.
                                                                  Dies beinhaltet auch den <span class="clisting">xmlns:xml</span>-Namespace, der immer implizit deklariert wird. 
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">ExcludeXml</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Liefert alle Namespaces, die im Gültigkeitsbereich des aktuellen Knotens definiert
                                                                  sind. Davon ausgeschlossen ist der <span class="clisting">xmlns:xml</span>-Namespace, der immer implizit deklariert ist.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">Local</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Liefert alle Namespaces, die am aktuellen Knoten lokal definiert sind.</p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Im folgenden Codefragment wird die Liste der Namespaces eines XML-Dokuments abgefragt,
                                                      ohne den impliziten <span class="clisting">xmlns:xml</span>-Namespace zu berücksichtigen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">IDictionary&lt;string, string&gt; liste = <br xmlns="">  navi.<span class="clistingfett">GetNamespacesInScope</span>(XmlNamespaceScope.ExcludeXml);<br xmlns="">foreach (KeyValuePair&lt;string, string&gt; temp in liste)<br xmlns="">  Console.WriteLine("Key: {0,-3} Value: {1}", temp.Key, temp.Value);<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.44  </span>Liste aller Namespaces abfragen
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Alternativ zu <span class="clisting">GetNamespacesInScope</span> bieten sich auch die Methoden <span class="clisting">MoveToFirstNamespace</span> und <span class="clisting">MoveToNextNamespace</span> an, die beide auf den aktuellen Knoten bezogen sind. Beide Methoden liefern einen
                                                      booleschen Wert zurück, der <span class="clisting">true</span> ist, wenn der <span class="clisting">XPathNavigator</span> auf den ersten bzw. nächsten Namespace positioniert werden kann.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">if (navigator.<span class="clistingfett">MoveToFirstNamespace</span>())<br xmlns="">do {<br xmlns="">  Console.WriteLine("Präfix: {0} - Namespace: {1} ", <br xmlns="">                     navigator.Name, navigator.Value);<br xmlns="">} while (navigator.<span class="clistingfett">MoveToNextNamespace</span>());<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Beachten Sie, dass ein Präfix mit der Eigenschaft <span class="clisting">Name</span> ausgewertet wird und der zugehörige Namensraum mit der Eigenschaft <span class="clisting">Value</span>. 
                                                   </p>
                                                   <h4 class="t4"> Namespaces in XPath-Ausdrücken</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Eine etwas andere Behandlung erfahren die Namespaces, die in XPath-Ausdrücken verwendet
                                                      und korrekt ausgewertet werden sollen. Grundsätzlich verlangt die XPath-Syntax, dass
                                                      vor dem Elementnamen das Präfix angegeben wird, also:
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="ckursiv">Präfix:Elementbezeichner</span></p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Eine Überladung der <span class="clisting">Select</span>-Methode des <span class="clisting">XPathNavigators</span> berücksichtigt genau diesen Fall und schreibt ein Objekt mit <span class="clisting">IXmlNamespaceResolver</span> vor. Diese Schnittstelle wird von der Klasse <span class="clisting">XmlNamespaceManager</span> implementiert. Sie müssen also nur ein Objekt dieses Typs der <span class="clisting">Select</span>-Methode übergeben.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ein <span class="clisting">XmlNamespaceManager</span> verwaltet alle Namespaces und die ihnen zugeordneten Präfixe. Dabei müssen die Elemente,
                                                      die sich im Standardnamensraum befinden, besonders behandelt werden, denn in XML-Dokumenten
                                                      ist diesen Elementen kein Präfix vorangestellt. Die XPath-Syntax verlangt aber auch
                                                      in diesem Fall ein Präfix. Daher ist es erforderlich, dass Sie auch diesen Elementen
                                                      ein Präfix zuordnen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Das folgende Beispiel zeigt, wie Sie die Klasse <span class="clisting">XmlNamespaceManager</span> einsetzen und einen Standard-Namespace definieren können. Beachten Sie dabei, dass
                                                      jeder gefundene Namespace explizit dem <span class="clisting">XmlNamespaceManager</span>-Objekt mit <span class="clisting">AddNamespace</span> hinzugefügt werden muss.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint"><span class="clistingfett">// Beispiel: ..\Kapitel 14\XPathWithNamespaces</span><br></br>static void Main(string[] args)<br xmlns="">{<br xmlns="">  XPathDocument xPathDoc = new XPathDocument(@"..\..\Personen.xml");<br xmlns="">  XPathNavigator navigator = xPathDoc.CreateNavigator();<br></br>  // XmlNamespaceManager instanziieren<br></br>  XmlNamespaceManager mgr = <span class="clistingfett">new XmlNamespaceManager(new NameTable()</span>);<br xmlns="">  navigator.MoveToRoot();<br xmlns="">  if (navigator.MoveToChild(XPathNodeType.Element)) {<br xmlns="">    foreach (KeyValuePair&lt;string, string&gt; temp in <br xmlns="">        navigator.GetNamespacesInScope(XmlNamespaceScope.All))<br></br>      // Namespaces zum XmlNamespaceManager hinzufügen<br></br>      if (temp.Key == "")<br xmlns="">        mgr.<span class="clistingfett">AddNamespace</span>("default", temp.Value);<br xmlns="">      else<br xmlns="">        mgr.<span class="clistingfett">AddNamespace</span>(temp.Key, temp.Value);<br xmlns="">  }<br></br>  // Ausgabe aller Person-Elemente, die dem durch 'x'  <br></br>  // beschriebenen Namespace zugeordnet werden<br></br>  XPathNodeIterator iterator = navigator.Select("//x:Person", mgr);<br xmlns="">  while (iterator.MoveNext()) {<br xmlns="">    Console.WriteLine(iterator.Current.Value);<br xmlns="">  }<br xmlns="">  Console.ReadLine();<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.45  </span>Beispielprogramm »XPathWithNamespaces«
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die verwendete <span class="ckursiv">Personen.xml</span> ist in diesem Fall:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">&lt;?xml version="1.0" encoding="utf-8"?&gt; <br xmlns="">&lt;x:Personen xmlns="http://www.MyDefaultNS.de"<br xmlns="">            xmlns:x="http://www.MyNS.de"&gt; <br xmlns="">  &lt;x:Person&gt; <br xmlns="">    &lt;x:Zuname&gt;Kleynen&lt;/x:Zuname&gt; <br xmlns="">    &lt;x:Vorname&gt;Peter&lt;/x:Vorname&gt; <br xmlns="">    &lt;Adresse Ort="Eifel" Strasse="Am Wald 1"&gt;Germany&lt;/Adresse&gt; <br xmlns="">  &lt;/x:Person&gt; <br xmlns="">&lt;/x:Personen&gt;<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 14.46  </span>Das in Listing 14.45 verwendete XML-Dokument
                                                   </p><br><hr><a name="kommentar"></a><h3>Ihr Kommentar</h3>
                                                   <p>Wie hat Ihnen das &lt;openbook&gt; gefallen? Wir freuen uns immer über Ihre freundlichen
                                                      und kritischen Rückmeldungen.
                                                   </p>
                                                   <!--<form action="http://www.galileo-press.de/feedback/openbook" method="post" style="text-align: center; margin-top: 10px;"><input type="hidden" name="openbookurl" value="https://www.galileo-press.de/openbook/?GPP=opvcs14_007.html"><input type="hidden" name="buchtitel" value="Visual C# 2012"><input type="hidden" name="Kapitel" value="14  XML"><table border="0">
                                                         <tbody>
                                                            <tr>
                                                               <td><label for="name">Name</label><br></td>
                                                               <td><input type="text" name="name" id="name" size="40"><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td><label for="email">E-Mail</label><br></td>
                                                               <td><input type="text" name="email" id="email" size="40"><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td valign="top"><label for="comment">Ihr Kommentar</label><br></td>
                                                               <td><textarea name="comment" id="comment" rows="10" cols="40"></textarea><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td></td>
                                                               <td><input type="submit" value="Kommentar absenden"></td>
                                                            </tr>
                                                         </tbody>
                                                      </table>
                                                   </form>--><a href="https://www.galileo-press.de/feedback/produkt/3243/">>> Zum Feedback-Formular</a>
                                                </div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                              <tr>
                                 <td width="100%" class="start" colspan="1" height="22" align="center">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                       <tbody>
                                          <tr>
                                             <td width="25%"><a href="1997_14_006.html" class="navnav"> &lt;&lt; zurück</a></td>
                                             <td width="49%">
                                                <div align="center"><a class="navnav" href="#">&lt;top&gt;</a></div>
                                             </td>
                                             <td align="right" width="25%">
                                                <div align="right"><a href="1997_14_008.html" class="navnav">vor &gt;&gt;
                                                      </a></div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                  </div>
               </td>
               <td width="10" valign="top"></td>
               <td width="160" valign="top"><table border="0" cellpadding="0" cellspacing="0" width="160">
                  <tbody><tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2">
                  &nbsp;<a href="https://www.galileo-press.de/?GPP=opvcs" class="autor">
                  <strong>Zum Katalog</strong></a>
                  </td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2">
                  <img src="common/leer.gif" border="0" height="1" width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td><a href="https://www.galileo-press.de/3243/?GPP=opvcs">
                  <img src="common/1997.png" width="118" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Visual C# 2012" title="Zum Katalog: Visual C# 2012">
                  <br><br><strong>Visual C# 2012</strong><br><img src="common/pfeil_rechts5.gif" border="0"
                  alt="">Jetzt bestellen</a><br /><br />
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2"><span class="autor"><strong>&nbsp;Ihre Meinung?</strong></a></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td>Wie hat Ihnen das &lt;openbook&gt; gefallen?<br><a href="#kommentar"><img src="common/pfeil_rechts5.gif"
                  border="0" alt="">Ihre Meinung</a>
                  <br><br></td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2">&nbsp;<a href="https://www.galileo-press.de/?GPP=opvcs"
                  class="autor"><strong>Buchempfehlungen</strong></a></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3175/?GPP=opvcs">
                  <img src="common/1954.png" width="113" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Professionell entwickeln mit Visual C# 2012"><br><br><br><br><br><br>&nbsp;Professionell<br>&nbsp;entwickeln mit<br>&nbsp;Visual C# 2012</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3179/?GPP=opvcs">
                  <img src="common/1956.png" width="118" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Windows Presentation Foundation 4.5"><br><br><br><br><br><br><br>&nbsp;Windows Presentation<br>&nbsp;Foundation 4.5<br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3196/?GPP=opvcs">
                  <img src="common/1968.png" width="111" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Windows Store Apps mit XAML und C#"><br><br><br><br><br><br><br>&nbsp;Windows Store Apps<br>&nbsp;mit XAML und C#<br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3189/?GPP=opvcs">
                  <img src="common/1960.png" width="110" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Einstieg in Visual C# 2012"><br><br><br><br><br><br><br>&nbsp;Einstieg in<br>&nbsp;Visual C# 2012</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3214/?GPP=opvcs">
                  <img src="common/1967.png" width="110" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Einstieg in WPF 4.5"><br><br><br><br><br><br><br>&nbsp;Einstieg in WPF 4.5</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/2853/?GPP=opvcs">
                  <img src="common/1756.png" width="121" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Schrödinger programmiert C++"><br><br><br><br><br><br><br>&nbsp;Schrödinger<br>&nbsp;programmiert C++</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/2824/?GPP=opvcs">
                  <img src="common/1732.png" width="109" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: C++11 programmieren"><br><br><br><br><br><br><br>&nbsp;C++11 programmieren</a><br><br></td>
                  </tr>
                  </table></td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2"><span class="autor"><strong>&nbsp;Shopping</strong></span></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td><b>Versandkostenfrei</b> bestellen in Deutschland und &Ouml;sterreich<br><a href="https://www.galileo-press.de/hilfe/bestellung_6?GPP=opvcs"><img
                  src="common/pfeil_rechts5.gif" border="0" alt="Info">Info</a><br><br></td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </tbody></table>
                  <br><br><hr align="center" width="70%"><br><div align="center">
                  <p class="standard"><b>Copyright © Galileo Press 2013</b><br>Für Ihren privaten Gebrauch
                  dürfen Sie die Online-Version natürlich ausdrucken. Ansonsten unterliegt das &lt;openbook&gt;
                  denselben Bestimmungen, wie die gebundene Ausgabe: Das Werk einschließlich aller seiner
                  Teile ist urheberrechtlich geschützt. Alle Rechte vorbehalten einschließlich der Vervielfältigung,
                  Übersetzung, Mikroverfilmung sowie Einspeicherung und Verarbeitung in elektronischen
                  Systemen.</p><br><a href="https://www.galileo-press.de/">[Galileo Computing]</a><br><br>Galileo
                  Press, Rheinwerkallee 4, 53227 Bonn, Tel.: 0228.42150.0, Fax 0228.42150.77, <a href="mailto:info@galileo-press.de">info@galileo-press.de</a></div><br><br>
               </td>
            </tr>
         </tbody>
      </table>
   </body>
</html>