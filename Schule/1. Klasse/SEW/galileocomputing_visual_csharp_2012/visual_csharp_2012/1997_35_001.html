<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
      <meta name="title" content="Galileo Computing :: Visual C# 2012 - 35  ADO.NET &#8211; Aktualisieren der Datenbank">
      <meta name="author" content="Andreas Kühnel">
      <meta name="publisher" content="Galileo Press">
      <meta name="copyright" content="© Galileo Press, Bonn 2013">
      <meta name="Desription" content="Visual C# 2012 - Das umfassende Handbuch - 35  ADO.NET &#8211; Aktualisieren der Datenbank">
      <meta name="robots" content="INDEX,FOLLOW">
      <meta http-equiv="content-language" content="de">
      <title>Galileo Computing :: Visual C# 2012 - 35  ADO.NET &#8211; Aktualisieren der Datenbank</title>
      <link rel="stylesheet" type="text/css" href="common/galileo_open.css">
      <link rel="stylesheet" type="text/css" href="common/prettify.css">
      <link rel="stylesheet" type="text/css" media="screen" href="common/css/lightbox.css"><script type="text/javascript" src="common/js/prototype.js"></script><script src="common/js/scriptaculous.js?load=effects,builder"></script><script type="text/javascript" src="common/js/lightbox.js"></script><link rel="prev" href="34_007.html">
      <link rel="next" href="1997_35_002.html"><script type="text/javascript" src="common/prettify.js"></script><script type="text/javascript" src="common/openwin.js"></script></head>
   <body vlink="#000099" link="#000099" alink="#000099" onload="prettyPrint()">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#000066">
         <tr>
            <td height="74" valign="bottom" colspan="2"><a href="https://www.galileo-press.de/openbook/?GPP=opvcs"><img src="common/galileocomputing_openbook.gif" width="200" height="56" border="0" alt="Galileo Computing < openbook &gt;" title="Galileo Computing < openbook &gt;"></a></td>
            <td width="80" height="74"><a href="https://www.galileo-press.de/3243/?GPP=opvcs"><img src="common/galileocomputing.gif" border="0" alt="Galileo Computing - Professionelle Bücher. Auch für Einsteiger." title="Galileo Computing - Professionelle Bücher. Auch für Einsteiger."></a></td>
         </tr>
      </table>
      <div align="right"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Professionelle Bücher. Auch für Einsteiger.</a></div><br><table class="tbl" border="0" cellpadding="0" cellspacing="0" width="100%">
         <tbody>
            <tr>
               <td width="190" valign="top">
                  <table class="tbl1" border="0" cellpadding="3" cellspacing="0" width="190" align="left">
                     <tbody>
                        <tr>
                           <td class="tbl2"><a class="nav" href="index.html">Inhaltsverzeichnis</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_00_001.html#dodtp98d144f0-bd8d-4de5-8086-32e7ca1478d7"> Vorwort zur 6. Auflage</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_01_001.html#dodtpf471901b-c92c-4256-b4a7-6c4233f40e97">1  Allgemeine Einführung in .NET</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_02_001.html#dodtpa6dfd9e4-6ebc-4240-b08a-4dd8e839b1e9">2  Grundlagen der Sprache C#</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_03_001.html#dodtpf766d18e-5ded-46aa-8e8e-625d86cb0d78">3  Das Klassendesign</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_04_001.html#dodtp1d1f07d4-0731-4e9c-8de8-d69493f7b393">4  Vererbung, Polymorphie und Interfaces</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_05_001.html#dodtp3fff44b2-cd1b-47b7-9a94-fbcb259a84b9">5  Delegates und Ereignisse</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_06_001.html#dodtpaccedd75-eaa3-4322-a479-e04396858096">6  Strukturen und Enumerationen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_07_001.html#dodtp77739224-c0d5-4b2a-9a3e-732e2dfca478">7  Fehlerbehandlung und Debugging</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_08_001.html#dodtp33cf4146-9c07-41aa-b128-fd667a737a33">8  Auflistungsklassen (Collections)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_09_001.html#dodtp066354eb-ea00-4a8d-aa5a-fa7bd96e026d">9  Generics &#8211; Generische Datentypen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_10_001.html#dodtp077ecd71-a5e8-46be-b6b5-6c31bc77dede">10  Weitere C#-Sprachfeatures</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_11_001.html#dodtp0c006063-d863-416e-b792-4cc39129b894">11  LINQ</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_12_001.html#dodtp2bfdab07-505d-4323-9885-77a8e59fa442">12  Arbeiten mit Dateien und Streams</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_13_001.html#dodtp49638af0-00f8-407f-9740-7dbc1e723fee">13  Binäre Serialisierung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_14_001.html#dodtp7327df50-2f94-44ea-8c62-26cb1aae6058">14  XML</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_15_001.html#dodtp61e706c0-d922-4db1-b2fb-cda3e1ff9a4c">15  Multithreading und die Task Parallel Library (TPL)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_16_001.html#dodtp1488d937-efc6-48e5-ba82-1547725215a5">16  Einige wichtige .NET-Klassen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_17_001.html#dodtp91f0667a-84db-4a4f-be78-6e8a0d8a3a2c">17  Projektmanagement und Visual Studio 2012</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_18_001.html#dodtp34972f67-6c1a-406f-a91d-ec8ff67058f9">18  Einführung in die WPF und XAML</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_19_001.html#dodtp2b691ef2-8859-4650-82c1-efe430ea7070">19  WPF-Layout-Container </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_20_001.html#dodtp7dad73d4-2c09-421f-a8d4-6a78c0a65acc">20  Fenster in der WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_21_001.html#dodtp193e3eb8-5130-4640-865a-fcdd743bac28">21  WPF-Steuerelemente</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_22_001.html#dodtp189c6448-45c3-4ee3-bf41-19ecfa0010d0">22  Elementbindungen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_23_001.html#dodtp5183a0da-5247-4a7c-ad83-22accc03224d">23  Konzepte von WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_24_001.html#dodtp0784a527-2ec1-411a-b5e4-add26ed79abb">24  Datenbindung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_25_001.html#dodtp5c4c4699-998d-48a0-b449-ac86d57d6ddb">25  Weitere Möglichkeiten der Datenbindung</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_26_001.html#dodtp5591376e-61df-4e77-a551-681b9cc62287">26  Dependency Properties</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_27_001.html#dodtp00fbcc96-1850-421c-a0b4-f4f585913905">27  Ereignisse in der WPF</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_28_001.html#dodtp0b2d55e9-c350-4f4b-b729-796ab6e638ec">28  WPF-Commands</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_29_001.html#dodtp3d560bbc-9ede-4881-af9f-d9c24c8c5ae8">29  Benutzerdefinierte Controls</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_30_001.html#dodtp6f0f9b84-f8f1-405a-b963-d9c64c6cf3d4">30  2D-Grafik</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_31_001.html#dodtpe8718b27-0d2c-45fd-a030-421a21b5d151">31  ADO.NET &#8211; Verbindungsorientierte Objekte</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_32_001.html#dodtp5631780e-021d-4716-a880-7604e981153d">32  ADO.NET &#8211; Das Command-Objekt</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_33_001.html#dodtp3e44ce92-e1cb-4420-9294-a993f673d1e4">33  ADO.NET &#8211; Der SqlDataAdapter</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_34_001.html#dodtp02622bf1-44a0-453d-828f-5266aea64a96">34  ADO.NET &#8211; Daten im lokalen Speicher </a></td>
                        </tr>
                        <tr>
                           <td><a class="navh" href="#dodtp44f9b504-b660-4f2e-bd26-072f4a498332">35  ADO.NET &#8211; Aktualisieren der Datenbank</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_36_001.html#dodtpd2ab99b1-a59b-43ef-abb1-e6775e3dddf5">36  Stark typisierte DataSets</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_37_001.html#dodtp97eab997-f0da-4739-b514-a73fccd2935a">37  Einführung in das ADO.NET Entity Framework</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_38_001.html#dodtp106a1823-39fd-4557-8819-0e6be4db7cce">38  Datenabfragen des Entity Data Models (EDM)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_39_001.html#dodtpcc04d69d-d046-42b7-a6f1-37c7e83c0276">39  Entitätsaktualisierung und Zustandsverwaltung </a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_40_001.html#dodtp6a9ab46f-1f4f-41d8-9ab8-bd419b300904">40  Konflikte behandeln</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="1997_41_001.html#dodtp160fa133-1df6-4ab9-a622-c56d87121c23">41  Plain Old CLR Objects (POCOs)</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="stichwort.html">Stichwort</a></td>
                        </tr>
                        <tr>
                           <td><br><a class="navnav"><strong>Download:</strong></a>
                               <br><a href="http://download2.galileo-press.de/openbook/galileocomputing_visual_csharp_2012.zip" class="navnav">- openbook, ca. 26,1 MB</a>
                               <br><a href="http://download2.galileo-press.de/openbook/galileocomputing_visual_csharp_2012_beispiele.zip" class="navnav">- Beispiele, ca. 62,4 MB</a>
                           </td>
                        </tr>
                        <tr>
                           <td><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Buch bestellen</a></td>
                        </tr>
                        <tr>
                           <td><a class="navnav" href="#kommentar">Ihre Meinung?</a><br><br></td>
                        </tr>
                     </tbody>
                  </table>
               </td>
               <td width="10"><img src="common/spacer10.gif" width="10" height="10" alt="Spacer"></td>
               <td width="85%" valign="top">
                  <div style="line-height:100%">
                     <div align="center">
                        <table width="98%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                           <tbody>
                              <tr>
                                 <td width="100%" class="start" colspan="1" height="22" align="center">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                       <tbody>
                                          <tr>
                                             <td width="25%">
                                                <div align="left"><a href="1997_34_007.html" class="navnav"> &lt;&lt; zurück</a></div>
                                             </td>
                                             <td width="49%">
                                                <div align="center"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="navnav">Galileo Computing</a> / <a href="https://www.galileo-press.de/openbook/?GPP=opvcs" class="navnav">
                                                      &lt;openbook&gt;</a> / <a href="index.html" class="navnav">Visual C# 2012</a></div>
                                             </td>
                                             <td width="25%">
                                                <div align="right"><a href="1997_35_002.html" class="navnav">vor &gt;&gt; </a></div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                              <tr>
                                 <td width="100%" valign="top">
                                    <table width="100%" border="0" cellpadding="10" cellspacing="0" class="box">
                                       <tbody>
                                          <tr>
                                             <td colspan="2"><a href="https://www.galileo-press.de/3243/?GPP=opvcs" class="buchtitel">Visual C# 2012</a><span class="autor"> von Andreas Kühnel</span><br><span class="untertitel">Das umfassende Handbuch</span></td>
                                          </tr>
                                          <tr>
                                             <td valign="top" width="211">
                                                <dl>
                                                   <dt><a href="http://www.galileo-press.de/3243/?GPP=opvcs" class="navnav"><img src="common/9783836219976.png" border="0" alt="Buch: Visual C# 2012" title="Buch: Visual C# 2012"></a></dt>
                                                   <dd><br><a href="http://www.galileo-press.de/3243/?GPP=opvcs"><span class="autor"><strong>Visual C# 2012</strong><br><pressinfo><strong>Galileo Computing</strong><br>1402 S., 6., aktualisierte und erweiterte Auflage 2013, geb., mit DVD<br>49,90 Euro, ISBN 978-3-8362-1997-6
                                                            </pressinfo></span></a></dd>
                                                </dl>
                                             </td>
                                             <td width="80%">
                                                <table border="0">
                                                   <tbody>
                                                      <tr>
                                                         <td valign="baseline"><img src="common/pfeil_u.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="3" class="kap"><strong><a href="1997_35_001.html#dodtp44f9b504-b660-4f2e-bd26-072f4a498332" class="navh">35 ADO.NET &#8211; Aktualisieren der Datenbank</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_35_001.html#dodtpfe133832-ca67-4d3a-8baa-b8380c216093" class="navh">35.1 Aktualisieren mit dem »CommandBuilder«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_001.html#dodtp11837306-232b-460a-a45f-26076a944d9b" class="navh">35.1.1 Die von »SqlCommandBuilder« generierten Aktualisierungsstatements</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_001.html#dodtp3b4d6b04-3215-4edf-a4bb-8b57c73153c3" class="navh">35.1.2 Konfliktsteuerung in einer Mehrbenutzerumgebung</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_001.html#dodtpb2034c8d-dcf6-4b2c-bd52-c45ec4750a31" class="navh">35.1.3 Die Eigenschaft »ConflictOption« des »SqlCommandBuilders«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_001.html#dodtp720c4fda-20a8-43ca-a633-1aa27a0ac906" class="navh">35.1.4 Die Eigenschaft »SetAllValues«</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_35_002.html#dodtp92ec7315-8023-480a-ad54-e5df65d73802" class="navnav">35.2 Manuell gesteuerte Aktualisierung</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_002.html#dodtpc762aa5d-17bd-4060-8362-0a7e699cebe0" class="navnav">35.2.1 Eigene Aktualisierungslogik</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_002.html#dodtpa1bba101-e7bd-4e6f-9b86-128a81d9944d" class="navnav">35.2.2 Das Beispielprogramm</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_35_003.html#dodtpc0ec01b5-5b37-4833-8c32-7bc44c0a7531" class="navnav">35.3 Konfliktanalyse</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_003.html#dodtpeba88095-0e56-4e4d-9767-643d15fed310" class="navnav">35.3.1 Den Benutzer über fehlgeschlagene Aktualisierungen informieren</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline"><strong><a href="1997_35_003.html#dodtp85fe1afc-36fa-460c-9701-acf3a61afadc" class="navnav">35.3.2 Konfliktverursachende Datenzeilen bei der Datenbank abfragen</a></strong></td>
                                                      </tr>
                                                      <tr>
                                                         <td valign="baseline" width="10"></td>
                                                         <td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="Pfeil"></td>
                                                         <td valign="baseline" colspan="2"><strong><a href="1997_35_004.html#dodtpd82eda3c-2b16-4e8c-a8bd-1bb60ff3cd11" class="navnav">35.4 Neue Autoinkrementwerte abrufen</a></strong></td>
                                                      </tr>
                                                   </tbody>
                                                </table>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                    <table width="100%" cellpadding="20" cellspacing="0" border="0" bgcolor="#eeeeee">
                                       <tbody>
                                          <tr>
                                             <td>
                                                <div class="main"><a id="dodtp44f9b504-b660-4f2e-bd26-072f4a498332" name="dodtp44f9b504-b660-4f2e-bd26-072f4a498332"></a><h1 class="t1"><span class="cfett">35 </span><span class="cfett"> ADO.NET &#8211; Aktualisieren der Datenbank</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpfe133832-ca67-4d3a-8baa-b8380c216093"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a></h1><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtpfe133832-ca67-4d3a-8baa-b8380c216093" name="dodtpfe133832-ca67-4d3a-8baa-b8380c216093"></a><h2 class="t2"><span class="cfett">35.1    </span><span class="cfett"> Aktualisieren mit dem »CommandBuilder«</span><a xmlns="http://www.w3.org/1999/xhtml" class="indexterm" id="dodtp01a85fd2-d575-47a4-ad4e-697aa827ef68"></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp11837306-232b-460a-a45f-26076a944d9b"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp44f9b504-b660-4f2e-bd26-072f4a498332"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h2>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Eine <span class="clisting">DataTable</span> können Sie mit Daten aus jeder Datenquelle füllen. Handelt es sich dabei um eine
                                                      Datenbank und können die Benutzer die Daten auch ändern, müssen die Änderungen zu
                                                      einem bestimmten Zeitpunkt an die Datenbank übermittelt werden. Des Öfteren habe ich
                                                      bereits die <span class="clisting">Update</span>-Methode des <span class="clisting">DataAdapters</span> erwähnt, die eine Verbindung zu der Datenbank aufbaut, um deren Datenbestand zu aktualisieren.
                                                      Vielleicht haben Sie auch schon die <span class="clisting">Update</span>-Methode getestet, nachdem Sie Zeilen Ihres <span class="clisting">DataSets</span> geändert hatten. Sie werden dabei bestimmt einen Laufzeitfehler erhalten haben. Sehen
                                                      Sie sich dazu das folgende Beispiel an, in dem eine neue Datenzeile hinzugefügt und
                                                      eine vorhandene geändert wird. Nach Abschluss der Änderungen wird die Methode <span class="clisting">Update</span> des <span class="clisting">SqlDataAdapters</span> aufgerufen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint"><span class="clistingfett">// Beispiel: ..\Kapitel 35\CommandBuilderSample</span><br></br>class Program {<br></br><span class="clistingfett">  static void Main(string[] args)</span> {<br xmlns="">    SqlConnection con = new SqlConnection();<br xmlns="">    con.ConnectionString = "...";<br xmlns="">    SqlCommand cmd = new SqlCommand();<br xmlns="">    cmd.Connection = con;<br xmlns="">    cmd.CommandText = "SELECT ProductID, ProductName, " +<br xmlns="">                      "UnitsInStock, Discontinued FROM Products";<br xmlns="">    DataSet ds = new DataSet();<br xmlns="">    SqlDataAdapter da = new SqlDataAdapter(cmd);<br xmlns="">    da.FillSchema(ds, SchemaType.Source);<br xmlns="">    ds.Tables[0].Columns["ProductID"].AutoIncrementSeed = -1;<br xmlns="">    ds.Tables[0].Columns["ProductID"].AutoIncrementStep = -1;<br xmlns="">    da.Fill(ds);<br></br>    // Neue Datenzeile hinzufügen<br></br>    DataRow newRow = ds.Tables[0].NewRow();<br xmlns="">    newRow["ProductName"] = "Camembert";<br xmlns="">    newRow["UnitsInStock"] = 100;<br xmlns="">    newRow["Discontinued"] = false;<br xmlns="">    ds.Tables[0].Rows.Add(newRow);<br></br>    // Datenzeile ändern<br></br>    DataRow[] editRow = ds.Tables[0].Select("ProductName='Tofu'");<br xmlns="">    if (editRow.Length == 1) {<br xmlns="">      editRow[0].BeginEdit();<br xmlns="">      editRow[0]["UnitsInStock"] = 1000;<br xmlns="">      editRow[0].EndEdit();<br xmlns="">    }<br xmlns="">    else<br xmlns="">      Console.WriteLine("Datenzeile 'Tofu' nicht gefunden.");<br></br>    // Datenbank aktualisieren<br></br>    int count = da.Update(ds);<br xmlns="">    Console.WriteLine("{0} Datenzeilen aktualisiert", count);<br xmlns="">    Console.ReadLine();<br xmlns="">  }<br xmlns="">}<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 35.1  </span>Aktualisieren einer Datenbank (verursacht einen Fehler)
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Wo liegt aber nun die Ursache des in der Anweisung, die die Methode <span class="clisting">Update</span> aufruft, auftretenden Laufzeitfehlers?
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Denken wir einmal daran, wie die Abfolge ist, bis der <span class="clisting">SqlDataAdapter</span> eine Auswahlabfrage an die Datenbank schickt. Wir hatten ein <span class="clisting">SqlCommand</span>-Objekt erzeugt und diesem das SELECT-Statement übergeben. Bei der Instanziierung
                                                      haben wir dem <span class="clisting">SqlDataAdapter</span> das <span class="clisting">SqlCommand</span>-Objekt über den Konstruktoraufruf bekannt gegeben. Der <span class="clisting">SqlDataAdapter</span> speichert das in seiner Eigenschaft <span class="clisting">SelectCommand</span>.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der <span class="clisting">SqlDataAdapter</span> hat aber noch drei weitere Eigenschaften, die nach einem <span class="clisting">SqlCommand</span>-Objekt verlangen:
                                                   </p>
                                                   <ul xmlns="http://www.w3.org/1999/xhtml">
                                                      <li class="pgp"><span class="clisting">InsertCommand</span></li>
                                                      <li class="pgp"><span class="clisting"><a class="indexterm" id="dodtpb403b403-695f-4901-a581-d2fe41e90d1d"></a></span><span class="clisting">DeleteCommand</span></li>
                                                      <li class="pgp"><a class="indexterm" id="dodtpda174e67-a837-47c4-9a6c-a518ccb789ef"></a><span class="clisting">UpdateCommand</span></li>
                                                   </ul>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><a class="indexterm" id="dodtp794b635f-8200-4609-ac3d-519ca6efc548"></a>So wie über <span class="clisting">SelectCommand</span> die vom <span class="clisting">SqlDataAdapter</span> abzusetzende Auswahlabfrage bekannt ist, benötigt der Adapter auch noch <span class="clisting">SqlCommand</span>-Objekte, die die SQL-Statements INSERT, DELETE und UPDATE beschreiben.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Erfreulicherweise stellt der <span class="clisting">SqlDataAdapter</span> nicht nach festgeschriebenen Regeln automatisch Aktualisierungsstatements bereit.
                                                      Dieses Verhalten gibt uns jedoch die Möglichkeit, selbst Einfluss auf die Aktualisierung
                                                      zu nehmen. Darauf werden wir später noch genauer eingehen. Die Folge ist jedenfalls,
                                                      dass die Eigenschaften <span class="clisting">Insert</span>-, <span class="clisting">Update</span>- und <span class="clisting">DeleteCommand</span> zunächst den Inhalt <span class="clisting">null</span> haben.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Für das Erzeugen von SQL-Aktualisierungsstatements bietet uns ADO.NET die Klasse <span class="clisting">SqlCommandBuilder</span>. Übergeben Sie bei der Instanziierung dieser Klasse dem Konstruktor die Referenz
                                                      auf den <span class="clisting">SqlDataAdapter</span>.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">SqlCommandBuilder cmb = new SqlCommandBuilder(da);<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Da der <span class="clisting">SqlCommandBuilder</span> nun das <span class="clisting">SqlDataAdapter</span>-Objekt kennt, weiß er, wie die SELECT-Auswahlabfrage aussieht. Auf dieser Grundlage
                                                      erzeugt <span class="clisting">SqlCommandBuilder</span> die SQL-Befehle INSERT, DELETE und UPDATE, verpackt sie in eine Zeichenfolge und
                                                      weist sie jeweils einem neuen <span class="clisting">SqlCommand</span>-Objekt zu. Die drei <span class="clisting">SqlCommand</span>-Objekte werden den Eigenschaften <span class="clisting">UpdateCommand</span>, <span class="clisting">InsertCommand</span> und <span class="clisting">DeleteCommand</span> des <span class="clisting">SqlDataAdapters</span> übergeben. Unabhängig davon, ob im <span class="clisting">DataSet</span> eine Zeile gelöscht, hinzugefügt oder editiert worden ist, wird der <span class="clisting">SqlDataAdapter</span> mit den vom <span class="clisting">SqlCommandBuilder</span> erzeugten Kommandos die Originaldatenbank aktualisieren.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Kommen wir zu dem eingangs gezeigten Beispiel zurück. Wenn Sie vor dem Aufruf von
                                                      <span class="clisting">Update</span> ein <span class="clisting">SqlCommandBuilder</span>-Objekt erzeugen und dessen Konstruktor die Instanz des <span class="clisting">SqlDataAdapters</span> übergeben, wird die Aktualisierung erfolgreich sein.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">[...]<br xmlns="">SqlCommandBuilder cmb = new SqlCommandBuilder(da);<br xmlns="">da.Update(ds);<br></pre></div><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp11837306-232b-460a-a45f-26076a944d9b" name="dodtp11837306-232b-460a-a45f-26076a944d9b"></a><h3 class="t3"><span class="cfett">35.1.1    </span><span class="cfett"> Die von »SqlCommandBuilder« generierten Aktualisierungsstatements</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp3b4d6b04-3215-4edf-a4bb-8b57c73153c3"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpfe133832-ca67-4d3a-8baa-b8380c216093"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard"><span class="clisting">SqlCommandBuilder</span> erzeugt Aktualisierungscode auf Grundlage des SELECT-Statements. Doch wie sieht die
                                                      Aktualisierungslogik exakt aus? Wir wollen uns das nun ansehen. Grundlage dazu bildet
                                                      die Abfrage:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">SELECT ProductID, ProductName, UnitsInStock FROM Products<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sie können sich die Aktualisierungsstatements ausgeben lassen, indem Sie die Methoden
                                                      <span class="clisting">GetUpdateCommand</span>, <span class="clisting">GetInsertCommand</span> oder <span class="clisting">GetDeleteCommand</span> des <span class="clisting">SqlCommandBuilders</span> aufrufen. Alle liefern ein Objekt vom Typ <span class="clisting">SqlCommand</span>, über dessen Eigenschaft <span class="clisting">CommandText</span> Sie das jeweilige SQL-Statement abfragen können. Es genügt, wenn wir uns nur eines
                                                      der drei ansehen.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE [Products]<br xmlns="">SET [ProductName] = @p1, [UnitsInStock] = @p2<br xmlns="">WHERE (([ProductID] = @p3) AND ([ProductName] = @p4) AND<br xmlns="">((@p5 = 1 AND [UnitsInStock] IS NULL) OR ([UnitsInStock] = @p6)))<br></pre></div>
                                                   <p class="plistingunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Listing 35.2  </span>Vom CommandBuilder generiertes SQL-UPDATE-Statement
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sie erkennen, dass hinter der WHERE-Klausel alle Spalten der SELECT-Abfrage als Suchkriterium
                                                      nach dem zu editierenden Datensatz aufgeführt sind. Die Parameter <span class="ckursiv">@p3</span> bis <span class="ckursiv">@p6</span> werden mit den Daten gefüllt, die unter <span class="clisting">DataRowVersion.Original</span> aus dem <span class="clisting">Dataset</span> bezogen werden, <span class="ckursiv">@p1</span> bis <span class="ckursiv">@p3</span> erhalten die Daten aus <span class="clisting">DataRowVersion.Current</span>. In gleicher Weise werden auch die INSERT- und DELETE-Anweisungen vom <span class="clisting">SqlCommandBuilder</span> generiert.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp3b4d6b04-3215-4edf-a4bb-8b57c73153c3" name="dodtp3b4d6b04-3215-4edf-a4bb-8b57c73153c3"></a><h3 class="t3"><span class="cfett">35.1.2    </span><span class="cfett"> Konfliktsteuerung in einer Mehrbenutzerumgebung</span><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpb2034c8d-dcf6-4b2c-bd52-c45ec4750a31"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp11837306-232b-460a-a45f-26076a944d9b"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Meistens werden Datenbanken in einem Netzwerk betrieben. Das ist ein ganz wesentlicher
                                                      Gesichtspunkt bei der Bereitstellung der SQL-Aktualisierungsstatements, denn in solchen
                                                      Umgebungen müssen wir nun noch die Möglichkeit betrachten, dass ein zweiter User gleichzeitig
                                                      mit denselben Daten arbeitet. Dann stellt sich auch sofort die Frage, was passiert,
                                                      wenn versucht wird, eine Datenzeile zu aktualisieren, die ein anderer Benutzer zwischenzeitlich
                                                      geändert hat. Möglicherweise tritt dabei ein Konflikt auf. Ob ein Konflikt auftritt,
                                                      hängt ganz entscheidend davon ab, wie die WHERE-Klausel des Aktualisierungsstatements
                                                      formuliert ist. Dabei müssen wir mehrere Fälle betrachten, die wir nun theoretisch
                                                      untersuchen wollen. 
                                                   </p>
                                                   <h4 class="t4"> Die WHERE-Klausel enthält alle Spalten</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Betrachten wir sofort ein Beispiel, wenn alle Spalten der SELECT-Abfrage in der WHERE-Klausel
                                                      angegeben sind, und nehmen wir an, Anwender A und Anwender B rufen praktisch gleichzeitig
                                                      dieselbe Datenzeile in der Produkttabelle auf. Ändert Anwender A die Spalte <span class="ckursiv">ProductName</span>, könnte das UPDATE-Statement beispielsweise wie folgt aussehen:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName="Kuchen", UnitsInStock=18<br xmlns="">WHERE ProductID=1 AND ProductName="Chai" AND<br xmlns="">UnitsInStock=18<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">In der WHERE-Klausel sind den Spaltenangaben genau die Werte zugeordnet, die Anwender
                                                      A aus der Datenbank bezogen hat. Anwender A aktualisiert erfolgreich, weil die Datenzeile,
                                                      die von der WHERE-Klausel beschrieben wird, in der Datenbank gefunden wird.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Danach versucht Anwender B seine Aktualisierung der Datenbank mitzuteilen. Ob er dabei
                                                      die Spalte <span class="ckursiv">ProductName</span> geändert hat oder <span class="ckursiv">UnitsInStock</span>, spielt keine Rolle. Entscheidend ist, dass die WHERE-Klausel die Spalten <span class="ckursiv">ProductID</span>, <span class="ckursiv">UnitsInStock</span> und <span class="ckursiv">ProductName</span> enthält.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName="Senf", UnitsInStock=56<br xmlns="">WHERE ProductID=1 AND ProductName="Chai" AND<br xmlns="">UnitsInStock=18<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der Aktualisierungsversuch wird scheitern. Schade, aber ein Datensatz mit dem Primärschlüssel
                                                      1 und den Spalteninhalten <span class="ckursiv">ProductName = Chai</span> und <span class="ckursiv">UnitsInStock = 18</span> wird nicht mehr gefunden, weil ein Anwender den Produktnamen vorher geändert hat.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="kasten">
                                                      <p class="pbstandard">Immer dann, wenn beim Absetzen eines UPDATE- oder DELETE-Statements in der WHERE-Klausel
                                                         eine Datenzeile beschrieben wird, die nicht in der Datenbank gefunden wird, haben
                                                         wir es mit einem Konflikt zu tun.
                                                      </p>
                                                   </div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Bei diesem Szenario »gewinnt« immer der Anwender, der als Erster seine Änderungen
                                                      an die Datenbank übermittelt. Der Anwender, der seine Änderungen später zur Datenbank
                                                      schickt, hat das Nachsehen. Sein Aktualisierungsversuch misslingt. Es kommt zu einem
                                                      Parallelitätskonflikt. Dieses Szenario wird auch als <span class="cfett">First-in-wins</span> bezeichnet. 
                                                   </p>
                                                   <h4 class="t4"> Die WHERE-Klausel enthält nur die Primärschlüsselspalte</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Betrachten wir nun einen anderen Fall. Wieder helfen uns die beiden fiktiven Anwender
                                                      A und B dabei, den Sachverhalt zu verstehen. Beide Anwender rufen praktisch gleichzeitig
                                                      dieselbe Datenzeile ab und nehmen Änderungen an einer der Spalten vor. Anwender A
                                                      aktualisiert die Originaldatenbank zuerst, beispielsweise die Spalte <span class="ckursiv">ProductName</span> des ersten Datensatzes:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName="Marmorkuchen", UnitsInStock=56<br xmlns="">WHERE ProductID=1<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Anwender B übermittelt seine Änderung, nachdem Anwender A den ersten Datensatz geändert
                                                      hat. Nehmen wir an, Anwender B hat den Inhalt in der Spalte <span class="ckursiv">UnitsInStock</span> editiert, so könnte sein vollständiges Aktualisierungsstatement wie folgt lauten:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName="Chai", UnitsInStock=56<br xmlns="">WHERE ProductID=1<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Aktualisierung wird erfolgreich sein, wenn der Datensatz mit der angegebenen <span class="ckursiv">ProductID</span> in der Tabelle gefunden wird. Die Änderungen von Anwender A sieht Anwender B nicht;
                                                      er wird vielleicht auch niemals erfahren, welche Daten Anwender A geändert hat, denn
                                                      er überschreibt die Änderung von Anwender A in der Spalte <span class="ckursiv">ProductName</span> mit dem alten Wert. Dieses Szenario, bei dem die letzte Änderung grundsätzlich immer
                                                      erfolgreich an die Datenbank übermittelt werden kann, wird als <span class="cfett">Last-in-wins</span> bezeichnet.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Identifizierung der zu ändernden Datenzeile nur anhand der Primärschlüsselspalte
                                                      ist folglich denkbar ungeeignet, wenn Sie vermeiden müssen, dass Anwender B unwissentlich
                                                      geänderte Daten überschreibt. Können Sie davon ausgehen, dass die letzte Aktualisierung
                                                      zweifelsfrei diejenige mit den »besten« Daten ist, sollten Sie sich für diese Variante
                                                      entscheiden.
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="kasten">
                                                      <p class="pbstandard">Natürlich wird es auch hier zu einem Konfliktfall kommen, sollte Anwender A dieselbe
                                                         Datenzeile nicht geändert, sondern bereits gelöscht haben.
                                                      </p>
                                                   </div>
                                                   <h4 class="t4"> Weitere Szenarien</h4>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die beiden zuvor beschriebenen Szenarien stellen Grenzfälle dar. Zwischen diesen beiden
                                                      gibt es, abhängig von der zugrunde liegenden Tabelle, unzählige weitere Optionen.
                                                      Gehen wir beispielsweise wieder davon aus, dass zwei Benutzer mit
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">SELECT ProductID, ProductName, UnitsInStock FROM Products<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Datenzeilen abrufen. Stellen wir uns weiter vor, dass der Artikelbestand <span class="ckursiv">UnitsInStock</span> durchaus überschrieben werden darf, aber eine Änderung der Spalte <span class="ckursiv">ProductName</span> nicht. Unabhängig davon, mit welchem UPDATE-Statement Benutzer A die Datenbank aktualisiert
                                                      hat, muss unser fiktiver Benutzer B das folgende UPDATE-Statement zur Datenbank schicken:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName="Kuchen", UnitsInStock=18<br xmlns="">WHERE ProductID=1 AND ProductName="Chai"<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Hat Anwender A nur den Lagerbestand <span class="ckursiv">UnitsInStock</span> geändert, wird der Datensatz gefunden, und die in der SET-Klausel angegebenen Werte
                                                      werden eingetragen. Dabei werden die neuen Daten des Anwenders A durch die alten Daten
                                                      überschrieben, weil die Spalte <span class="ckursiv">UnitsInStock</span> in der SET-Klausel von Anwender B enthalten ist.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Hat Anwender A jedoch den Artikelbezeichner <span class="ckursiv">ProductName</span> editiert, kommt es zu einem Konflikt. 
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Selbstverständlich könnte man sich auch vorstellen, dass die SET-Klausel nur die veränderten
                                                      Spaltenwerte beschreibt und die WHERE-Klausel neben der Angabe der Primärschlüsselspalte
                                                      nur die Spalten, die als konfliktverursachend eingestuft werden und darüber hinaus
                                                      auch verändert worden sind. Bezogen auf unser letztes Beispiel sollte das UPDATE-Statement
                                                      wie folgt aussehen:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName="Kuchen"<br xmlns="">WHERE ProductID=1 AND ProductName="Chai"<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Jetzt wird die Spalte <span class="ckursiv">UnitsInStock</span> nicht mehr in der SET-Klausel angeführt. Falls Anwender A diese Spalte geändert hat,
                                                      ist seine Aktualisierung weiterhin gültig, und in der Datenzeile wird nur der Produktbezeichner
                                                      editiert.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Sollten die beiden Extremszenarien <span class="ckursiv">Last-in-wins</span> und <span class="ckursiv">First-in-wins</span> nicht Ihren Anforderungen an die Aktualisierung entsprechen, öffnet sich ein weites
                                                      Feld der Möglichkeiten, das mit der Komplexität einer Tabelle größer wird. Hier bedarf
                                                      es sicherlich einer gründlichen Analyse, was im Einzelfall als Konflikt zu betrachten
                                                      ist.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtpb2034c8d-dcf6-4b2c-bd52-c45ec4750a31" name="dodtpb2034c8d-dcf6-4b2c-bd52-c45ec4750a31"></a><h3 class="t3"><span class="cfett">35.1.3    </span><span class="cfett"> Die Eigenschaft »ConflictOption« des »SqlCommandBuilders«</span><a xmlns="http://www.w3.org/1999/xhtml" class="indexterm" id="dodtp8ae718cf-7a6b-48d5-98e9-f7fd76ca0f4c"></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtp720c4fda-20a8-43ca-a633-1aa27a0ac906"><img src="common/down.gif" width="15" height="15" border="0" alt="Zur nächsten Überschrift"></img></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpd4c851b6-5e7f-4729-b69d-e5ba90dbef0e"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Grundsätzlich ist das Aktualisieren einer Datenquelle mit dem <span class="clisting">SqlCommandBuilder</span>-Objekt sehr einfach. Aber diese Einfachheit hat ihren Preis, denn wir müssen uns
                                                      mit den Charakteristiken des Objekts abfinden und haben nur wenig Einfluss darauf,
                                                      wie die Daten zurückgeschrieben werden. Der <span class="clisting">SqlCommandBuilder</span> generiert, wie Sie weiter oben gesehen haben, Abfragen, die zur Identifikation einer
                                                      Datenzeile in der Tabelle einer Datenbank alle Spalten einschließen, die mit SELECT
                                                      abgefragt worden sind. Er bildet demnach per Vorgabe das <span class="ckursiv">First-in-wins</span>-Szenario ab. Eine Änderung der Daten in der Datenbank führt zu der Ausnahme <span class="clisting">DBConcurrencyException</span>, wenn ein anderer User eine dieser Spalten genau in dem Zeitraum verändert hat, in
                                                      dem die ursprünglichen Daten für die Zeile abgerufen und neue Werte für die Zeile
                                                      übermittelt werden.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Dieses Verhalten ist nicht immer wünschenswert. Daher stellt Ihnen der <span class="clisting">SqlCommandBuilder</span> mit der Eigenschaft <span class="clisting">ConflictOption</span> eine Möglichkeit zur Verfügung, das Aktualisierungsverhalten zu beeinflussen. Die
                                                      Eigenschaft ist vom Typ der gleichnamigen Enumeration, deren Mitglieder Sie Tabelle
                                                      35.1 entnehmen können.
                                                   </p>
                                                   <table width="100%" border="0" cellspacing="1" cellpadding="3">
                                                      <caption class="tabunter">
                                                         <p class="ptabellenunter"><span xmlns="http://www.w3.org/1999/xhtml" class="nummerierung">Tabelle 35.1  </span>Die Enumeration »ConflictOption«
                                                         </p>
                                                      </caption>
                                                      <tbody>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenkopf">
                                                               
                                                               
                                                               
                                                               Konstante
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenkopf">Beschreibung
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">CompareAllSearchableValues</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">UPDATE- und DELETE-Anweisungen schließen alle Spalten aus der Tabelle, nach denen
                                                                  gesucht werden kann, in die WHERE-Klausel ein. Das ist der Standard.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">CompareRowVersion</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Wenn in der Tabelle eine Timestamps-Spalte vorhanden ist, wird sie in der WHERE-Klausel
                                                                  für alle generierten UPDATE-Anweisungen verwendet.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                         <tr xmlns="http://www.w3.org/1999/xhtml">
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext"><span class="clisting">OverwriteChanges</span></p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                            <td class="tabellenzelle">
                                                               <p class="tabellentext">Alle UPDATE- und DELETE-Anweisungen enthalten nur die Spalten des Primärschlüssels
                                                                  in der WHERE-Klausel.
                                                               </p>
                                                               
                                                               
                                                            </td>
                                                            
                                                            
                                                         </tr>
                                                         
                                                         
                                                      </tbody>
                                                   </table>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Der Wert <span class="clisting">ConflictOption.CompareAllSearchableValues</span> ist der Standardwert. In diesem Szenario wird immer die erste Änderung in einer Datenzeile
                                                      zum Erfolg, die dann folgende Änderung zu einem Konflikt führen. Dieses Szenario entspricht
                                                      dem <span class="ckursiv">First-in-wins-Szenario</span>. Das ist die Vorgabe.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Mit <span class="clisting">ConflictOption.OverwriteChanges</span> teilen Sie dem <span class="clisting">SqlCommandBuilder</span> mit, nur die Primärschlüsselspalte(n) in die WHERE-Klausel einzubeziehen. Das hat
                                                      zur Folge, dass die Änderungen des ersten Benutzers von den nachfolgenden Änderungen
                                                      überschrieben werden. Diese Einstellung bildet das <span class="ckursiv">Last-in-wins-Szenario</span> ab.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ein Timestamp ist ein automatisch generierter, eindeutiger 8-Byte-Wert. Mit Hilfe
                                                      der Timestamp-Spalte einer Zeile können Sie sehr einfach ermitteln, ob sich ein Wert
                                                      in der Datenzeile geändert hat, seit er eingelesen wurde. Der Timestamp-Wert wird
                                                      bei jeder Aktualisierung geändert. Ist er beim Absetzen des UPDATE-Statements identisch,
                                                      liegt keine andere zwischenzeitliche Aktualisierung vor. Mit <span class="clisting">ConflictOption.CompareRowVersion</span> weisen Sie den <span class="clisting">SqlCommandBuilder</span> an, in der WHERE-Klausel nur die Primärschlüsselspalte(n) und die Timestamp-Spalte
                                                      aufzunehmen.
                                                   </p><br><div align="center"><a href="#top"><img src="common/jupiters.gif" border="0" alt="Galileo Computing - Zum Seitenanfang"></a></div><a id="dodtp720c4fda-20a8-43ca-a633-1aa27a0ac906" name="dodtp720c4fda-20a8-43ca-a633-1aa27a0ac906"></a><h3 class="t3"><span class="cfett">35.1.4    </span><span class="cfett"> Die Eigenschaft »SetAllValues«</span><a xmlns="http://www.w3.org/1999/xhtml" class="indexterm" id="dodtpfe4f7f58-b16e-4973-a97a-63240e15d45f"></a><a xmlns="http://www.w3.org/1999/xhtml" href="#dodtpb2034c8d-dcf6-4b2c-bd52-c45ec4750a31"><img src="common/top.gif" width="15" height="15" border="0" alt="Zur vorigen Überschrift"></img></a></h3>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Betrachten Sie noch einmal das Beispiel mit Benutzer A und Benutzer B. Es wäre denkbar,
                                                      dass weder das <span class="ckursiv">Last-in-wins-</span> noch das <span class="ckursiv">First-in-wins</span>-Szenario die Forderung passend erfüllt.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Vielleicht soll auch jede Änderung an einer Datenzeile akzeptiert werden, solange
                                                      dieselbe Spalte nicht von einem anderen User verändert worden ist. Das bedeutet, dass
                                                      in der WHERE-Klausel neben dem Primärschlüssel auch die jeweils geänderte Spalte mit
                                                      ihrem Ursprungswert angegeben werden muss. Benutzer A müsste in einem solchen Fall
                                                      das folgende UPDATE absetzen:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET ProductName = "Cheese"<br xmlns="">WHERE ProductID = 55 AND ProductName = "Käse"<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Ändert Benutzer B unter gleichen Voraussetzungen die Spalte <span class="ckursiv">UnitsInStock</span>, wird diese Spalte seinem UPDATE-Statement hinzugefügt:
                                                   </p>
                                                   <div xmlns="http://www.w3.org/1999/xhtml" class="listing"><pre class="prettyprint">UPDATE Products<br xmlns="">SET UnitsInStock = 2<br xmlns="">WHERE ProductID = 55 AND UnitsInStock = 13<br></pre></div>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Die Aktualisierung wird erfolgreich sein. Mehr noch, die betroffene Datenzeile in
                                                      der Datenbank wird beide Änderungen aufweisen.
                                                   </p>
                                                   <p xmlns="http://www.w3.org/1999/xhtml" class="pstandard">Setzen Sie die Eigenschaft <span class="clisting">SetAllValues</span> des <span class="clisting">SqlCommandBuilders</span> auf <span class="clisting">false</span>, werden neben der Primärschlüsselspalte nur die Spalten der WHERE-Klausel als Suchkriterium
                                                      hinzugefügt, deren Inhalte sich verändert haben. Das entspricht genau dem gezeigten
                                                      Muster. 
                                                   </p><br><hr><a name="kommentar"></a><h3>Ihr Kommentar</h3>
                                                   <p>Wie hat Ihnen das &lt;openbook&gt; gefallen? Wir freuen uns immer über Ihre freundlichen
                                                      und kritischen Rückmeldungen.
                                                   </p>
                                                   <!--<form action="http://www.galileo-press.de/feedback/openbook" method="post" style="text-align: center; margin-top: 10px;"><input type="hidden" name="openbookurl" value="https://www.galileo-press.de/openbook/?GPP=opvcs35_001.html"><input type="hidden" name="buchtitel" value="Visual C# 2012"><input type="hidden" name="Kapitel" value="35  ADO.NET &#8211; Aktualisieren der Datenbank"><table border="0">
                                                         <tbody>
                                                            <tr>
                                                               <td><label for="name">Name</label><br></td>
                                                               <td><input type="text" name="name" id="name" size="40"><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td><label for="email">E-Mail</label><br></td>
                                                               <td><input type="text" name="email" id="email" size="40"><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td valign="top"><label for="comment">Ihr Kommentar</label><br></td>
                                                               <td><textarea name="comment" id="comment" rows="10" cols="40"></textarea><br></td>
                                                            </tr>
                                                            <tr>
                                                               <td></td>
                                                               <td><input type="submit" value="Kommentar absenden"></td>
                                                            </tr>
                                                         </tbody>
                                                      </table>
                                                   </form>--><a href="https://www.galileo-press.de/feedback/produkt/3243/">>> Zum Feedback-Formular</a>
                                                </div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                              <tr>
                                 <td width="100%" class="start" colspan="1" height="22" align="center">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                       <tbody>
                                          <tr>
                                             <td width="25%"><a href="1997_34_007.html" class="navnav"> &lt;&lt; zurück</a></td>
                                             <td width="49%">
                                                <div align="center"><a class="navnav" href="#">&lt;top&gt;</a></div>
                                             </td>
                                             <td align="right" width="25%">
                                                <div align="right"><a href="1997_35_002.html" class="navnav">vor &gt;&gt;
                                                      </a></div>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                  </div>
               </td>
               <td width="10" valign="top"></td>
               <td width="160" valign="top"><table border="0" cellpadding="0" cellspacing="0" width="160">
                  <tbody><tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2">
                  &nbsp;<a href="https://www.galileo-press.de/?GPP=opvcs" class="autor">
                  <strong>Zum Katalog</strong></a>
                  </td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2">
                  <img src="common/leer.gif" border="0" height="1" width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td><a href="https://www.galileo-press.de/3243/?GPP=opvcs">
                  <img src="common/1997.png" width="118" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Visual C# 2012" title="Zum Katalog: Visual C# 2012">
                  <br><br><strong>Visual C# 2012</strong><br><img src="common/pfeil_rechts5.gif" border="0"
                  alt="">Jetzt bestellen</a><br /><br />
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2"><span class="autor"><strong>&nbsp;Ihre Meinung?</strong></a></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td>Wie hat Ihnen das &lt;openbook&gt; gefallen?<br><a href="#kommentar"><img src="common/pfeil_rechts5.gif"
                  border="0" alt="">Ihre Meinung</a>
                  <br><br></td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  </td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2">&nbsp;<a href="https://www.galileo-press.de/?GPP=opvcs"
                  class="autor"><strong>Buchempfehlungen</strong></a></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3175/?GPP=opvcs">
                  <img src="common/1954.png" width="113" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Professionell entwickeln mit Visual C# 2012"><br><br><br><br><br><br>&nbsp;Professionell<br>&nbsp;entwickeln mit<br>&nbsp;Visual C# 2012</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3179/?GPP=opvcs">
                  <img src="common/1956.png" width="118" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Windows Presentation Foundation 4.5"><br><br><br><br><br><br><br>&nbsp;Windows Presentation<br>&nbsp;Foundation 4.5<br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3196/?GPP=opvcs">
                  <img src="common/1968.png" width="111" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Windows Store Apps mit XAML und C#"><br><br><br><br><br><br><br>&nbsp;Windows Store Apps<br>&nbsp;mit XAML und C#<br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3189/?GPP=opvcs">
                  <img src="common/1960.png" width="110" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Einstieg in Visual C# 2012"><br><br><br><br><br><br><br>&nbsp;Einstieg in<br>&nbsp;Visual C# 2012</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/3214/?GPP=opvcs">
                  <img src="common/1967.png" width="110" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Einstieg in WPF 4.5"><br><br><br><br><br><br><br>&nbsp;Einstieg in WPF 4.5</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/2853/?GPP=opvcs">
                  <img src="common/1756.png" width="121" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: Schrödinger programmiert C++"><br><br><br><br><br><br><br>&nbsp;Schrödinger<br>&nbsp;programmiert C++</a><br><br></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td><td valign="top">
                  <a href="http://www.galileo-press.de/2824/?GPP=opvcs">
                  <img src="common/1732.png" width="109" height="90" border="0" align="left" hspace="4"
                  vspace="8" alt="Zum Katalog: C++11 programmieren"><br><br><br><br><br><br><br>&nbsp;C++11 programmieren</a><br><br></td>
                  </tr>
                  </table></td>
                  </tr>
                  <tr>
                  <td><img src="common/leer.gif" height="2" width="1" border="0" /></img></td>
                  </tr>
                  <tr>
                  <td>
                  <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                  <td class="start" height="20" colspan="2"><span class="autor"><strong>&nbsp;Shopping</strong></span></td>
                  </tr>
                  <tr>
                  <td valign="top" class="tbl4" width="2"><img src="common/leer.gif" border="0" height="1"
                  width="1"></td>
                  <td valign="top">
                  <table cellspacing="3">
                  <tr>
                  <td><b>Versandkostenfrei</b> bestellen in Deutschland und &Ouml;sterreich<br><a href="https://www.galileo-press.de/hilfe/bestellung_6?GPP=opvcs"><img
                  src="common/pfeil_rechts5.gif" border="0" alt="Info">Info</a><br><br></td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </table>
                  </td>
                  </tr>
                  </tbody></table>
                  <br><br><hr align="center" width="70%"><br><div align="center">
                  <p class="standard"><b>Copyright © Galileo Press 2013</b><br>Für Ihren privaten Gebrauch
                  dürfen Sie die Online-Version natürlich ausdrucken. Ansonsten unterliegt das &lt;openbook&gt;
                  denselben Bestimmungen, wie die gebundene Ausgabe: Das Werk einschließlich aller seiner
                  Teile ist urheberrechtlich geschützt. Alle Rechte vorbehalten einschließlich der Vervielfältigung,
                  Übersetzung, Mikroverfilmung sowie Einspeicherung und Verarbeitung in elektronischen
                  Systemen.</p><br><a href="https://www.galileo-press.de/">[Galileo Computing]</a><br><br>Galileo
                  Press, Rheinwerkallee 4, 53227 Bonn, Tel.: 0228.42150.0, Fax 0228.42150.77, <a href="mailto:info@galileo-press.de">info@galileo-press.de</a></div><br><br>
               </td>
            </tr>
         </tbody>
      </table>
   </body>
</html>